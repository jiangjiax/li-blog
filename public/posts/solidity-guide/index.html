<!DOCTYPE html>
<html lang="zh" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="icon" type="image/x-icon" href="../../static/images/favicon.ico">
    <title>
        
            æ¢ç´¢web3ä¸–ç•Œï¼šSolidity å®Œå…¨å…¥é—¨æŒ‡å— - é²¤å“¥çš„åšå®¢ - é²¤å“¥çš„åšå®¢
        
    </title>
    
    
    <meta name="description" content="æ¬¢è¿æ¥åˆ°ã€Šæ¢ç´¢ Web3 ä¸–ç•Œã€‹ç³»åˆ—æ–‡ç« ï¼Œæˆ‘æ˜¯é²¤å“¥ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å¸¦ä½ æ·±å…¥æ¢ç´¢ Solidityâ€”â€”ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦ç¼–ç¨‹è¯­è¨€ã€‚æ— è®ºä½ æ˜¯ç¼–ç¨‹æ–°æ‰‹è¿˜æ˜¯æœ‰ä¸€å®šç»éªŒçš„å¼€å‘è€…ï¼Œè¿™ç¯‡æ–‡ç« éƒ½å°†ä¸ºä½ æä¾›å®ç”¨çš„çŸ¥è¯†å’ŒæŠ€å·§ï¼Œå¸®åŠ©ä½ å¿«é€Ÿä¸Šæ‰‹ Solidityã€‚">
    
    <meta name="keywords" content="Solidity, åŒºå—é“¾, æ™ºèƒ½åˆçº¦, ä»¥å¤ªåŠ">
    
    <meta name="author" content="è’‹é²¤">
    
    
    <meta name="static-path" content="../../static">
    
    
    <link rel="stylesheet" href="/static/css/styles.built.css">

    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml" />
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="alternate" type="application/rss+xml" 
        title="é²¤å“¥çš„åšå®¢" 
        href="https://www.li-blog.top/feed.xml">
</head>
<body class="bg-white dark:bg-gray-900 min-h-full flex flex-col">
    
    <div id="stars-container" class="stars fixed inset-0 z-0 pointer-events-none"></div>

    
    
<header class="fixed top-0 w-full bg-stars-secondary/80 backdrop-blur-md z-50 border-b border-stars-accent/10">
    <nav class="container mx-auto px-4 py-4 flex justify-between items-center">
        <div class="flex items-center space-x-4">
            <a href="/" 
               class="text-xl font-bold text-stars-accent hover:text-stars-gold transition-all duration-300
                      relative group">
                <i class="fas fa-star mr-2 group-hover:rotate-180 transition-transform duration-500"></i>
                <span class="group-hover:tracking-wider transition-all duration-300">Stars</span>
                <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-stars-gold group-hover:w-full transition-all duration-300"></span>
            </a>
        </div>
        <div class="flex items-center space-x-6">
            <a href="/" class="nav-link group">
                <span class="relative">
                    é¦–é¡µ
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-stars-accent group-hover:w-full transition-all duration-300"></span>
                </span>
            </a>
            <a href="/posts" class="nav-link group">
                <span class="relative">
                    æ–‡ç« 
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-stars-accent group-hover:w-full transition-all duration-300"></span>
                </span>
            </a>
            <a href="/tags" class="nav-link group">
                <span class="relative">
                    æ ‡ç­¾äº‘
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-stars-accent group-hover:w-full transition-all duration-300"></span>
                </span>
            </a>
        </div>
    </nav>
</header>


    
    <main class="flex-grow pt-20 relative z-10">
        
<article class="container mx-auto px-4 pt-2 pb-10">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 lg:gap-8">
        
        <div class="lg:col-span-9">
            
            <header class="relative mb-6 lg:mb-10 p-6 lg:p-8 bg-stars-secondary/80 backdrop-blur-sm rounded-2xl border border-stars-accent/10
                         before:absolute before:inset-0 before:bg-gradient-to-br before:from-stars-accent/5 before:to-transparent before:rounded-2xl">
                
                
                <div class="relative mb-8">
                    <a href="#series-nav" 
                       class="inline-flex items-center gap-3 px-4 py-2 rounded-xl
                             bg-stars-primary/30 backdrop-blur-sm
                             border border-stars-accent/20 text-stars-accent
                             hover:bg-stars-accent/10 hover:scale-[1.02] 
                             transition-all duration-300 group">
                        <div class="flex items-center gap-2">
                            <span class="font-mono">æ¢ç´¢Web3ä¸–ç•Œ</span>
                        </div>
                        <span class="px-2 py-0.5 text-sm rounded-full bg-stars-accent/10 group-hover:bg-stars-accent/20">
                            Part 5
                        </span>
                        <i class="fas fa-chevron-down text-xs opacity-70 group-hover:translate-y-0.5 transition-transform"></i>
                    </a>
                </div>
                

                
                <h1 class="relative text-3xl sm:text-4xl lg:text-5xl font-bold text-stars-accent mb-4 lg:mb-6
                           leading-tight tracking-tight font-display">
                    æ¢ç´¢web3ä¸–ç•Œï¼šSolidity å®Œå…¨å…¥é—¨æŒ‡å—
                </h1>

                
                
                <p class="relative text-base lg:text-lg text-stars-muted mb-6 lg:mb-8 leading-relaxed max-w-3xl">
                    æ¬¢è¿æ¥åˆ°ã€Šæ¢ç´¢ Web3 ä¸–ç•Œã€‹ç³»åˆ—æ–‡ç« ï¼Œæˆ‘æ˜¯é²¤å“¥ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å¸¦ä½ æ·±å…¥æ¢ç´¢ Solidityâ€”â€”ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦ç¼–ç¨‹è¯­è¨€ã€‚æ— è®ºä½ æ˜¯ç¼–ç¨‹æ–°æ‰‹è¿˜æ˜¯æœ‰ä¸€å®šç»éªŒçš„å¼€å‘è€…ï¼Œè¿™ç¯‡æ–‡ç« éƒ½å°†ä¸ºä½ æä¾›å®ç”¨çš„çŸ¥è¯†å’ŒæŠ€å·§ï¼Œå¸®åŠ©ä½ å¿«é€Ÿä¸Šæ‰‹ Solidityã€‚
                </p>
                

                
                <div class="relative flex flex-col gap-4 sm:flex-row sm:items-center sm:gap-6">
                    
                    <div class="flex items-center gap-6 text-sm text-stars-muted">
                        <time class="flex items-center gap-2 px-3 py-1.5 rounded-lg bg-stars-primary/20">
                            <i class="far fa-calendar-alt"></i>
                            2025-01-23
                        </time>
                        <span class="flex items-center gap-2 px-3 py-1.5 rounded-lg bg-stars-primary/20">
                            <i class="far fa-clock"></i>
                            15 min read
                        </span>
                    </div>

                    
                    <div class="flex flex-wrap gap-2">
                        
                        <span class="px-3 py-1.5 text-sm rounded-lg
                                   bg-stars-primary/20 text-stars-muted
                                   border border-stars-accent/10
                                   hover:bg-stars-accent/5 hover:text-stars-accent
                                   transition-colors duration-300 cursor-default">
                            <i class="fas fa-tag text-xs mr-2 opacity-70"></i>
                            Solidity
                        </span>
                        
                        <span class="px-3 py-1.5 text-sm rounded-lg
                                   bg-stars-primary/20 text-stars-muted
                                   border border-stars-accent/10
                                   hover:bg-stars-accent/5 hover:text-stars-accent
                                   transition-colors duration-300 cursor-default">
                            <i class="fas fa-tag text-xs mr-2 opacity-70"></i>
                            åŒºå—é“¾
                        </span>
                        
                        <span class="px-3 py-1.5 text-sm rounded-lg
                                   bg-stars-primary/20 text-stars-muted
                                   border border-stars-accent/10
                                   hover:bg-stars-accent/5 hover:text-stars-accent
                                   transition-colors duration-300 cursor-default">
                            <i class="fas fa-tag text-xs mr-2 opacity-70"></i>
                            æ™ºèƒ½åˆçº¦
                        </span>
                        
                        <span class="px-3 py-1.5 text-sm rounded-lg
                                   bg-stars-primary/20 text-stars-muted
                                   border border-stars-accent/10
                                   hover:bg-stars-accent/5 hover:text-stars-accent
                                   transition-colors duration-300 cursor-default">
                            <i class="fas fa-tag text-xs mr-2 opacity-70"></i>
                            ä»¥å¤ªåŠ
                        </span>
                        
                    </div>
                </div>
            </header>

            
            <div class="relative group space-y-8 lg:space-y-12">
                
                <div class="bg-stars-secondary/80 backdrop-blur-sm rounded-2xl border border-stars-accent/10 overflow-hidden">
                    
                    

                    
                    <div class="content p-5 sm:p-6 lg:p-8 prose prose-stars max-w-none">
                        <h2 id="heading">åŸºç¡€çŸ¥è¯†</h2>
<p>åœ¨å¼€å§‹ç¼–å†™æ™ºèƒ½åˆçº¦ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆäº†è§£ä¸€äº›åŸºç¡€æ¦‚å¿µã€‚å°±åƒç›–æˆ¿å­éœ€è¦å…ˆæ‰“å¥½åœ°åŸºä¸€æ ·ï¼Œè¿™äº›åŸºç¡€çŸ¥è¯†å°†å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œå¼€å‘ Solidity åˆçº¦ã€‚</p>
<h3 id="-solidity">ä¸ºä»€ä¹ˆé€‰æ‹© Solidityï¼Ÿ</h3>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœä½ æƒ³åˆ›å»ºä¸€ä¸ªå®Œå…¨å»ä¸­å¿ƒåŒ–çš„åº”ç”¨ï¼Œæ¯”å¦‚ä¸€ä¸ªä¸éœ€è¦ä¸­é—´å•†çš„äºŒæ‰‹äº¤æ˜“å¹³å°ï¼Œæˆ–è€…ä¸€ä¸ªå…¬å¹³é€æ˜çš„æŠ½å¥–ç³»ç»Ÿï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°æ™ºèƒ½åˆçº¦ã€‚è€Œ Solidity å°±æ˜¯æœ€æµè¡Œçš„æ™ºèƒ½åˆçº¦ç¼–ç¨‹è¯­è¨€ã€‚</p>
<p>ä½¿ç”¨ Solidityï¼Œä½ å¯ä»¥ï¼š</p>
<ul>
<li>åˆ›å»ºå»ä¸­å¿ƒåŒ–åº”ç”¨ï¼ˆDAppsï¼‰ï¼šæ¯”å¦‚å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€ã€NFT å¸‚åœºç­‰</li>
<li>å‘è¡Œè‡ªå·±çš„ä»£å¸ï¼šæ— è®ºæ˜¯ ERC-20 ä»£å¸è¿˜æ˜¯ NFT</li>
<li>æ„å»º DeFi åè®®ï¼šæ¯”å¦‚å€Ÿè´·å¹³å°ã€æµåŠ¨æ€§æŒ–çŸ¿ç­‰</li>
</ul>
<h3 id="remix-ide">å¼€å‘ç¯å¢ƒï¼šRemix IDE</h3>
<p>ä½œä¸ºåˆå­¦è€…ï¼Œæˆ‘å¼ºçƒˆæ¨èä½¿ç”¨ Remix IDEã€‚å®ƒå°±åƒæ˜¯æ™ºèƒ½åˆçº¦å¼€å‘çš„&quot;ç‘å£«å†›åˆ€&quot;ï¼Œæä¾›äº†ä½ éœ€è¦çš„ä¸€åˆ‡å·¥å…·ã€‚</p>
<p>ä¸ºä»€ä¹ˆé€‰æ‹© Remixï¼Ÿ</p>
<ul>
<li>æ— éœ€å®‰è£…ï¼šç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€å°±èƒ½ç”¨</li>
<li>å†…ç½®ç¼–è¯‘å™¨ï¼šè‡ªåŠ¨æ£€æŸ¥ä»£ç é”™è¯¯</li>
<li>æ¨¡æ‹Ÿç¯å¢ƒï¼šå¯ä»¥å…è´¹æµ‹è¯•åˆçº¦</li>
<li>è°ƒè¯•å·¥å…·ï¼šå¸®ä½ æ‰¾å‡ºä»£ç ä¸­çš„é—®é¢˜</li>
</ul>
<p>å¼€å§‹ä½¿ç”¨ Remixï¼š</p>
<ol>
<li>æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® <a href="https://remix.ethereum.org/">Remix å®˜æ–¹ç½‘ç«™</a></li>
<li>ç¬¬ä¸€æ¬¡æ‰“å¼€å¯èƒ½ä¼šçœ‹åˆ°å¾ˆå¤šæ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä»¬å…ˆæŠŠå®ƒä»¬éƒ½åˆ é™¤ï¼Œåªä¿ç•™ <code>contracts</code> æ–‡ä»¶å¤¹</li>
<li>åœ¨ <code>contracts</code> æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªåˆçº¦æ–‡ä»¶ï¼Œæ¯”å¦‚ <code>MyFirstContract.sol</code></li>
</ol>
<blockquote>
<p>å°è´´å£«ï¼šRemix æä¾›äº†å¤šä¸ªä¸»é¢˜ï¼Œå¦‚æœä½ å–œæ¬¢æ·±è‰²æ¨¡å¼ï¼Œå¯ä»¥åœ¨è®¾ç½®ä¸­åˆ‡æ¢ã€‚é•¿æ—¶é—´ç¼–ç æ—¶ï¼Œæ·±è‰²ä¸»é¢˜ä¼šè®©çœ¼ç›æ›´èˆ’æœã€‚</p>
</blockquote>
<h3 id="heading-1">æ•°æ®å­˜å‚¨ä½ç½®</h3>
<p>åœ¨ä»¥å¤ªåŠä¸­ï¼Œå­˜å‚¨æ•°æ®æ˜¯éœ€è¦ä»˜è´¹çš„ã€‚å°±åƒç§Ÿæˆ¿å­ä¸€æ ·ï¼Œå­˜å‚¨ç©ºé—´è¶Šå¤§ï¼Œè´¹ç”¨è¶Šé«˜ã€‚æ‰€ä»¥ç†è§£ä¸åŒçš„å­˜å‚¨ä½ç½®å¾ˆé‡è¦ï¼š</p>
<h4 id="storage">Storageï¼ˆæ°¸ä¹…å­˜å‚¨ï¼‰</h4>
<p>æƒ³è±¡ä¸€ä¸‹ä½ åœ¨åŒºå—é“¾ä¸Šç§Ÿäº†ä¸€ä¸ªæ°¸ä¹…çš„ä»“åº“ï¼Œæ‰€æœ‰æ”¾åœ¨è¿™é‡Œçš„æ•°æ®éƒ½ä¼šæ°¸ä¹…ä¿å­˜ï¼š</p>
<ul>
<li>ä¼˜ç‚¹ï¼šæ•°æ®æ°¸ä¹…å­˜åœ¨ï¼Œä»»ä½•æ—¶å€™éƒ½èƒ½è®¿é—®</li>
<li>ç¼ºç‚¹ï¼šgas è´¹ç”¨é«˜ï¼Œå› ä¸ºè¦æ°¸ä¹…å ç”¨åŒºå—é“¾ç©ºé—´</li>
</ul>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">StorageExample</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// è¿™äº›å˜é‡éƒ½å­˜å‚¨åœ¨ storage ä¸­
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">string</span> <span style="color:#66d9ef">public</span> name;           <span style="color:#75715e">// æ¯”å¦‚ç”¨æˆ·å
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint256</span> <span style="color:#66d9ef">public</span> balance;       <span style="color:#75715e">// è´¦æˆ·ä½™é¢
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">address</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">uint</span>) <span style="color:#66d9ef">public</span> userBalances;  <span style="color:#75715e">// ç”¨æˆ·ä½™é¢æ˜ å°„
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constructor</span>(<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span> _name) {
</span></span><span style="display:flex;"><span>        name <span style="color:#f92672">=</span> _name;    <span style="color:#75715e">// å°†ä¸´æ—¶æ•°æ®å­˜å…¥æ°¸ä¹…å­˜å‚¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">updateName</span>(<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span> _newName) <span style="color:#66d9ef">public</span> {
</span></span><span style="display:flex;"><span>        name <span style="color:#f92672">=</span> _newName; <span style="color:#75715e">// åŒæ ·æ˜¯ä¿®æ”¹æ°¸ä¹…å­˜å‚¨çš„æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><h4 id="memory">Memoryï¼ˆä¸´æ—¶å­˜å‚¨ï¼‰</h4>
<p>è¿™å°±åƒæ˜¯åœ¨å‡½æ•°è¿è¡Œæ—¶ç§Ÿç”¨çš„ä¸´æ—¶å·¥ä½œç©ºé—´ï¼š</p>
<ul>
<li>ä¼˜ç‚¹ï¼šgas è´¹ç”¨ä½ï¼Œé€‚åˆä¸´æ—¶è®¡ç®—</li>
<li>ç¼ºç‚¹ï¼šå‡½æ•°æ‰§è¡Œå®Œå°±æ¶ˆå¤±äº†</li>
</ul>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">MemoryExample</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">concatenateStrings</span>(<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span> str1, <span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span> str2) 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span>) 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// åœ¨ memory ä¸­è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">string</span>(abi.encodePacked(str1, str2));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">processArray</span>(<span style="color:#66d9ef">uint</span>[] <span style="color:#66d9ef">memory</span> numbers) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> sum <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">uint</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> numbers.length; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>            sum <span style="color:#f92672">+=</span> numbers[i];
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> sum;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><h3 id="import-">import å¯¼å…¥</h3>
<p>åœ¨å¼€å‘å¤§å‹é¡¹ç›®æ—¶ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦å°†ä»£ç åˆ†å‰²æˆå¤šä¸ªæ–‡ä»¶ï¼Œä»¥ä¾¿æ›´å¥½çš„ç»´æŠ¤é¡¹ç›®ã€‚import è¯­å¥å…è®¸æˆ‘ä»¬å¯¼å…¥å…¶ä»–æ–‡ä»¶ä¸­çš„åˆçº¦ã€åº“æˆ–æ¥å£ã€‚</p>
<ol>
<li>å¯¼å…¥æ•´ä¸ªæ–‡ä»¶ï¼š</li>
</ol>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;filename&#34;</span>;
</span></span></code></pre><ol start="2">
<li>å¯¼å…¥ç‰¹å®šéƒ¨åˆ†ï¼š</li>
</ol>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#f92672">import</span> {symbol1, symbol2} <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;filename&#34;</span>;
</span></span></code></pre><ol start="3">
<li>é‡å‘½åå¯¼å…¥çš„ç‰¹å®šéƒ¨åˆ†ï¼š</li>
</ol>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#f92672">import</span> {symbol1 <span style="color:#66d9ef">as</span> alias1, symbol2 <span style="color:#66d9ef">as</span> alias2} <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;filename&#34;</span>;
</span></span></code></pre><ol start="4">
<li>å¯¼å…¥æ‰€æœ‰å†…å®¹å¹¶æŒ‡å®šå‘½åç©ºé—´ï¼š</li>
</ol>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">as</span> namespace <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#34;filename&#34;</span>;
</span></span></code></pre><p>åœ¨ import è¯­å¥ä¸­ï¼Œè·¯å¾„å¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ï¼š</p>
<ul>
<li>ç›¸å¯¹è·¯å¾„ï¼šä»¥ ./ æˆ– ../ å¼€å¤´ï¼Œè¡¨ç¤ºç›¸å¯¹äºå½“å‰æ–‡ä»¶çš„è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œimport &quot;./Math.sol&quot;; è¡¨ç¤º Math.sol æ–‡ä»¶ä¸å½“å‰æ–‡ä»¶åœ¨åŒä¸€ç›®å½•ä¸‹ã€‚</li>
<li>ç»å¯¹è·¯å¾„ï¼šä»¥ / å¼€å¤´ï¼Œè¡¨ç¤ºä»é¡¹ç›®æ ¹ç›®å½•å¼€å§‹çš„ç»å¯¹è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œimport &quot;/contracts/Math.sol&quot;; è¡¨ç¤º Math.sol æ–‡ä»¶ä½äºé¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ contracts æ–‡ä»¶å¤¹ä¸­ã€‚</li>
</ul>
<h3 id="heading-2">ç‰ˆæƒå£°æ˜</h3>
<p>æ¯ä¸ª Solidity æ–‡ä»¶éƒ½åº”è¯¥ä»¥ä¸€ä¸ªç‰¹æ®Šçš„æ³¨é‡Šå¼€å§‹ï¼š<code>// SPDX-License-Identifier: MIT</code></p>
<p>è¿™è¡Œæ³¨é‡Šçœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†å®ƒéå¸¸é‡è¦ã€‚å®ƒå‘Šè¯‰å…¶ä»–å¼€å‘è€…å¦‚ä½•åˆæ³•åœ°ä½¿ç”¨ä½ çš„ä»£ç ã€‚å°±åƒåœ¨é¤å…ç‚¹èœæ—¶éœ€è¦çŸ¥é“ä»·æ ¼ä¸€æ ·ï¼Œå…¶ä»–å¼€å‘è€…åœ¨ä½¿ç”¨ä½ çš„ä»£ç æ—¶ä¹Ÿéœ€è¦çŸ¥é“ä½¿ç”¨æ¡ä»¶ã€‚</p>
<p>SPDXï¼ˆSoftware Package Data Exchangeï¼‰æ˜¯ä¸€ä¸ªæ ‡å‡†åŒ–çš„è®¸å¯è¯æ ‡è¯†ç¬¦ç³»ç»Ÿã€‚å¸¸è§çš„è®¸å¯è¯ç±»å‹åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>MIT</code>ï¼šæœ€å®½æ¾çš„è®¸å¯è¯ä¹‹ä¸€ï¼ŒåŸºæœ¬ä¸Šè¯´&quot;éšä¾¿ç”¨ï¼Œä½†åˆ«è¯´æ˜¯ä½ å†™çš„&quot;</li>
<li><code>GPL-3.0</code>ï¼šè¦æ±‚ä»»ä½•ä½¿ç”¨è¯¥ä»£ç çš„é¡¹ç›®ä¹Ÿå¿…é¡»å¼€æº</li>
<li><code>UNLICENSED</code>ï¼šä¿ç•™æ‰€æœ‰æƒåˆ©ï¼Œé€šå¸¸ç”¨äºç§æœ‰ä»£ç </li>
<li><code>Apache-2.0</code>ï¼šç±»ä¼¼ MITï¼Œä½†æä¾›ä¸“åˆ©æˆæƒæ¡æ¬¾</li>
</ul>
<p>å¦‚æœä¸æ·»åŠ è¿™ä¸ªæ³¨é‡Šä¼šæ€æ ·ï¼Ÿ</p>
<ul>
<li>å…¶ä»–å¼€å‘è€…å¯èƒ½ä¼šå› ä¸ºä¸æ¸…æ¥šä½¿ç”¨æ¡ä»¶è€ŒçŠ¹è±«æ˜¯å¦ä½¿ç”¨ä½ çš„ä»£ç </li>
<li>å¯èƒ½ä¼šåœ¨æœªæ¥é‡åˆ°æ³•å¾‹é—®é¢˜</li>
</ul>
<p>ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼š</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#75715e">// SPDX-License-Identifier: MIT
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">pragma solidity</span> <span style="color:#f92672">^</span><span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">8</span>.<span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">LicenseExample</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">string</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">constant</span> LICENSE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;MIT License - Feel free to use this code!&#34;</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getTerms</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;You can copy, modify, and distribute this code freely&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><h3 id="heading-3">ç‰ˆæœ¬å£°æ˜</h3>
<p>åœ¨ Solidity ä¸­ï¼Œç‰ˆæœ¬å£°æ˜æ˜¯éå¸¸é‡è¦çš„ã€‚å®ƒå‘Šè¯‰ç¼–è¯‘å™¨ä½¿ç”¨å“ªä¸ªç‰ˆæœ¬çš„ Solidity æ¥ç¼–è¯‘ä½ çš„ä»£ç ã€‚ä¸åŒç‰ˆæœ¬çš„ Solidity å¯èƒ½æœ‰ä¸åŒçš„ç‰¹æ€§å’Œè¯­æ³•ï¼Œæ‰€ä»¥æ˜ç¡®æŒ‡å®šç‰ˆæœ¬å¯ä»¥é¿å…å¾ˆå¤šæ½œåœ¨çš„é—®é¢˜ã€‚</p>
<p>ç‰ˆæœ¬å£°æ˜ä½¿ç”¨ <code>pragma solidity</code> å…³é”®å­—ï¼Œåé¢è·Ÿç€ç‰ˆæœ¬å·ã€‚æœ‰å‡ ç§å¸¸è§çš„ç‰ˆæœ¬å£°æ˜æ–¹å¼ï¼š</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#75715e">// 1. æŒ‡å®šå…·ä½“ç‰ˆæœ¬
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">pragma solidity</span> <span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">8</span>.<span style="color:#ae81ff">4</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 2. ä½¿ç”¨ ^ ç¬¦å·è¡¨ç¤ºå‘ä¸Šå…¼å®¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">pragma solidity</span> <span style="color:#f92672">^</span><span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">8</span>.<span style="color:#ae81ff">4</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 3. æŒ‡å®šç‰ˆæœ¬èŒƒå›´
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">pragma solidity</span> <span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">8</span>.<span style="color:#ae81ff">0</span> <span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">9</span>.<span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 4. ä½¿ç”¨ ~ ç¬¦å·è¡¨ç¤ºå…è®¸ä¿®è®¢ç‰ˆæœ¬æ›´æ–°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">pragma solidity</span> <span style="color:#f92672">~</span><span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">8</span>.<span style="color:#ae81ff">0</span>;
</span></span></code></pre><p>è®©æˆ‘ä»¬æ¥ç†è§£è¿™äº›ç‰ˆæœ¬å£°æ˜çš„å«ä¹‰ï¼š</p>
<ol>
<li>
<p><code>pragma solidity 0.8.4;</code></p>
<ul>
<li>ä¸¥æ ¼è¦æ±‚ä½¿ç”¨ 0.8.4 ç‰ˆæœ¬</li>
<li>æœ€ä¸¥æ ¼çš„ç‰ˆæœ¬æ§åˆ¶æ–¹å¼</li>
<li>é€‚ç”¨äºéœ€è¦ç¡®ä¿ä»£ç åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹è¿è¡Œçš„æƒ…å†µ</li>
</ul>
</li>
<li>
<p><code>pragma solidity ^0.8.4;</code></p>
<ul>
<li>å…è®¸ä½¿ç”¨ 0.8.4 åŠä»¥ä¸Šçš„ 0.8.x ç‰ˆæœ¬</li>
<li>ä¸å…è®¸ä½¿ç”¨ 0.9.0 åŠä»¥ä¸Šç‰ˆæœ¬</li>
<li>æœ€å¸¸ç”¨çš„ç‰ˆæœ¬å£°æ˜æ–¹å¼</li>
</ul>
</li>
<li>
<p><code>pragma solidity &gt;=0.8.0 &lt;0.9.0;</code></p>
<ul>
<li>æ˜ç¡®æŒ‡å®šç‰ˆæœ¬èŒƒå›´</li>
<li>å…è®¸ä½¿ç”¨ 0.8.0 åˆ° 0.9.0 ä¹‹é—´çš„ä»»ä½•ç‰ˆæœ¬</li>
<li>é€‚ç”¨äºéœ€è¦ç²¾ç¡®æ§åˆ¶ç‰ˆæœ¬èŒƒå›´çš„æƒ…å†µ</li>
</ul>
</li>
<li>
<p><code>pragma solidity ~0.8.0;</code></p>
<ul>
<li>å…è®¸ä¿®è®¢ç‰ˆæœ¬æ›´æ–°ï¼ˆç¬¬ä¸‰ä¸ªæ•°å­—çš„å˜åŒ–ï¼‰</li>
<li>ç­‰åŒäº &gt;=0.8.0 &lt;0.9.0</li>
</ul>
</li>
</ol>
<h3 id="heading-4">å®šä¹‰åˆçº¦</h3>
<p>ä½¿ç”¨ contract å…³é”®å­—å®šä¹‰åˆçº¦ï¼š</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">MyContract</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// åˆçº¦å†…å®¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre><hr />
<h2 id="heading-5">æ•°æ®ç±»å‹å’Œå˜é‡</h2>
<p>å˜é‡å°±åƒæ˜¯ä¸€ä¸ªä¸ªå¸¦æ ‡ç­¾çš„å®¹å™¨ï¼Œç”¨æ¥å­˜å‚¨å„ç§ç±»å‹çš„æ•°æ®ã€‚å°±åƒè¶…å¸‚é‡Œçš„è´§æ¶ä¸€æ ·ï¼Œä¸åŒçš„è´§æ¶ç”¨æ¥å­˜æ”¾ä¸åŒç±»å‹çš„å•†å“â€”â€”ä½ ä¸ä¼šæŠŠç‰›å¥¶æ”¾åœ¨è”¬èœæ¶ä¸Šï¼Œå¯¹å§ï¼Ÿ</p>
<h3 id="heading-6">åŸºæœ¬æ•°æ®ç±»å‹</h3>
<h4 id="bool">å¸ƒå°”å‹ï¼ˆboolï¼‰</h4>
<p>æœ€ç®€å•çš„æ•°æ®ç±»å‹,åªæœ‰ true å’Œ false ä¸¤ä¸ªå€¼ã€‚å°±åƒå¼€å…³çš„å¼€å’Œå…³ã€‚</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">bool</span> isPaused;
</span></span></code></pre><h4 id="integer">æ•´æ•°ç±»å‹ï¼ˆIntegerï¼‰</h4>
<p>Solidity æä¾›äº†ä¸¤ç§æ•´æ•°ç±»å‹ï¼š</p>
<ul>
<li>intï¼šå¯ä»¥è¡¨ç¤ºæ­£æ•°å’Œè´Ÿæ•°</li>
<li>uintï¼šåªèƒ½è¡¨ç¤ºæ­£æ•°(æ— ç¬¦å·æ•´æ•°)</li>
</ul>
<p>è¿™ä¸¤ç§ç±»å‹éƒ½æœ‰ä¸åŒçš„å¤§å°å˜ä½“,ä»8ä½åˆ°256ä½:</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">IntegerExample</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ç”¨äºå­˜å‚¨ç”¨æˆ·å¹´é¾„(0-255)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8</span> <span style="color:#66d9ef">public</span> age;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ç”¨äºå­˜å‚¨ä»£å¸ä½™é¢(å¯ä»¥å¾ˆå¤§)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint256</span> <span style="color:#66d9ef">public</span> balance;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ç”¨äºå­˜å‚¨æ¸©åº¦(å¯ä»¥ä¸ºè´Ÿ)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">int8</span> <span style="color:#66d9ef">public</span> temperature;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">setAge</span>(<span style="color:#66d9ef">uint8</span> _age) <span style="color:#66d9ef">public</span> {
</span></span><span style="display:flex;"><span>        require(_age <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">150</span>, <span style="color:#e6db74">&#34;Invalid age&#34;</span>);
</span></span><span style="display:flex;"><span>        age <span style="color:#f92672">=</span> _age;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æ³¨æ„æ•´æ•°æº¢å‡ºçš„é—®é¢˜
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">addToBalance</span>(<span style="color:#66d9ef">uint256</span> amount) <span style="color:#66d9ef">public</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// åœ¨ 0.8.0 ç‰ˆæœ¬ä¹‹å‰éœ€è¦æ‰‹åŠ¨æ£€æŸ¥æº¢å‡º
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        require(balance <span style="color:#f92672">+</span> amount <span style="color:#f92672">&gt;=</span> balance, <span style="color:#e6db74">&#34;Overflow&#34;</span>);
</span></span><span style="display:flex;"><span>        balance <span style="color:#f92672">+=</span> amount;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><blockquote>
<p>å°è´´å£«ï¼š</p>
<ol>
<li>ä½¿ç”¨æœ€å°å¤Ÿç”¨çš„æ•´æ•°ç±»å‹å¯ä»¥èŠ‚çœ gas</li>
<li>uint8 è™½ç„¶èŒƒå›´å°ï¼Œä½†åœ¨æ•°ç»„ä¸­å’Œå¾ªç¯ä¸­åè€Œä¼šæ¶ˆè€—æ›´å¤š gasï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</li>
</ol>
</blockquote>
<h4 id="-uint256--gas">ä¸ºä»€ä¹ˆ uint256 æœ‰æ—¶å€™æ›´çœ gasï¼Ÿ</h4>
<p>è¿™å¬èµ·æ¥å¯èƒ½æœ‰ç‚¹åç›´è§‰ï¼šæ˜æ˜ uint8 åªç”¨ 8 ä½å­˜å‚¨ï¼Œè€Œ uint256 ç”¨ 256 ä½å­˜å‚¨ï¼Œä¸ºä»€ä¹ˆ uint8 åè€Œä¼šæ¶ˆè€—æ›´å¤š gasï¼Ÿ</p>
<p>åŸå› åœ¨äº EVMï¼ˆä»¥å¤ªåŠè™šæ‹Ÿæœºï¼‰çš„å·¥ä½œæ–¹å¼ï¼š</p>
<ol>
<li>EVM çš„å­—é•¿æ˜¯ 256 ä½ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå¤©ç”Ÿå°±æ˜¯ä¸ºå¤„ç† 256 ä½çš„æ•°æ®ä¼˜åŒ–çš„</li>
<li>å½“ä½¿ç”¨å°äº 256 ä½çš„ç±»å‹æ—¶ï¼ˆæ¯”å¦‚ uint8ï¼‰ï¼ŒEVM éœ€è¦é¢å¤–çš„æ“ä½œæ¥ç¡®ä¿æ•°å€¼åœ¨æ­£ç¡®çš„èŒƒå›´å†…ï¼š<br />
- éœ€è¦é¢å¤–çš„æ©ç æ“ä½œæ¥æ¸…é™¤é«˜ä½<br />
- éœ€è¦é¢å¤–çš„æ£€æŸ¥æ¥ç¡®ä¿æ•°å€¼ä¸ä¼šè¶…å‡ºèŒƒå›´</li>
</ol>
<p>å®ç”¨å»ºè®®ï¼š</p>
<ol>
<li>åœ¨çŠ¶æ€å˜é‡ä¸­ï¼Œå¦‚æœç¡®å®åªéœ€è¦å­˜å‚¨å°èŒƒå›´çš„å€¼ï¼ˆæ¯”å¦‚å¹´é¾„ï¼‰ï¼Œä½¿ç”¨ uint8 å¯èƒ½æ›´çœå­˜å‚¨ç©ºé—´</li>
<li>åœ¨å‡½æ•°å†…éƒ¨çš„ä¸´æ—¶å˜é‡å’Œå¾ªç¯è®¡æ•°å™¨ä¸­ï¼Œä¼˜å…ˆä½¿ç”¨ uint256</li>
<li>åœ¨æ•°ç»„ä¸­ï¼Œå§‹ç»ˆä½¿ç”¨ uint256ï¼Œå› ä¸º uint8[] ä¼šå¯¼è‡´æ›´å¤šçš„æ‰“åŒ…å’Œè§£åŒ…æ“ä½œ</li>
</ol>
<h4 id="address">åœ°å€ç±»å‹ï¼ˆAddressï¼‰</h4>
<p>åœ°å€ç±»å‹æ˜¯ä»¥å¤ªåŠçš„ç‰¹è‰²,ç”¨äºå­˜å‚¨è´¦æˆ·åœ°å€ã€‚å°±åƒé“¶è¡Œè´¦å·ä¸€æ ·,æ¯ä¸ªåœ°å€éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">AddressExample</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// åˆçº¦æ‹¥æœ‰è€…åœ°å€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">address</span> <span style="color:#66d9ef">public</span> owner;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å¯ä»¥æ¥æ”¶ETHçš„åœ°å€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">address</span> <span style="color:#66d9ef">payable</span> <span style="color:#66d9ef">public</span> treasury;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ç”¨æˆ·ä½™é¢æ˜ å°„
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">address</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">uint</span>) <span style="color:#66d9ef">public</span> balances;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constructor</span>() {
</span></span><span style="display:flex;"><span>        owner <span style="color:#f92672">=</span> msg.sender;
</span></span><span style="display:flex;"><span>        treasury <span style="color:#f92672">=</span> <span style="color:#66d9ef">payable</span>(msg.sender);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å‘åˆçº¦å­˜æ¬¾
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">deposit</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">payable</span> {
</span></span><span style="display:flex;"><span>        balances[msg.sender] <span style="color:#f92672">+=</span> msg.value;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ä»åˆçº¦ææ¬¾
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">withdraw</span>(<span style="color:#66d9ef">uint</span> amount) <span style="color:#66d9ef">public</span> {
</span></span><span style="display:flex;"><span>        require(balances[msg.sender] <span style="color:#f92672">&gt;=</span> amount, <span style="color:#e6db74">&#34;Insufficient balance&#34;</span>);
</span></span><span style="display:flex;"><span>        balances[msg.sender] <span style="color:#f92672">-=</span> amount;
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// æ³¨æ„: å…ˆæ›´æ–°çŠ¶æ€å†è½¬è´¦,é˜²æ­¢é‡å…¥æ”»å‡»
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">payable</span>(msg.sender).transfer(amount);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æ£€æŸ¥åœ°å€æ˜¯å¦ä¸ºåˆçº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">isContract</span>(<span style="color:#66d9ef">address</span> account) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">view</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> size;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">assembly</span> { size <span style="color:#f92672">:=</span> <span style="color:#a6e22e">extcodesize</span>(account) }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">return</span> size <span style="color:#960050;background-color:#1e0010">&gt;</span> <span style="color:#ae81ff">0</span><span style="color:#960050;background-color:#1e0010">;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><h4 id="bytes">å­—èŠ‚ç±»å‹ï¼ˆBytesï¼‰</h4>
<p>å­—èŠ‚ç±»å‹ç”¨äºå­˜å‚¨åŸå§‹å­—èŠ‚æ•°æ®ã€‚å°±åƒè®¡ç®—æœºçš„DNAï¼Œå¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„äºŒè¿›åˆ¶æ•°æ®ã€‚</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#75715e">// å›ºå®šé•¿åº¦å­—èŠ‚æ•°ç»„,ç”¨äºå­˜å‚¨å“ˆå¸Œå€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">bytes32</span> <span style="color:#66d9ef">public</span> documentHash;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åŠ¨æ€é•¿åº¦å­—èŠ‚æ•°ç»„,ç”¨äºå­˜å‚¨å¯å˜é•¿åº¦æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">bytes</span> <span style="color:#66d9ef">public</span> dynamicData;
</span></span></code></pre><h3 id="heading-7">å¤æ‚æ•°æ®ç±»å‹</h3>
<h4 id="heading-8">æ•°ç»„</h4>
<p>æ•°ç»„æ˜¯ä¸€ç§ç”¨äºå­˜å‚¨ç›¸åŒç±»å‹å…ƒç´ çš„æ•°æ®ç»“æ„ã€‚å°±åƒä¸€æ’æ•´é½çš„å‚¨ç‰©æŸœï¼Œæ¯ä¸ªæŸœå­éƒ½ç”¨æ¥å­˜æ”¾ç›¸åŒç±»å‹çš„ç‰©å“ã€‚</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">ArrayExample</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å›ºå®šé•¿åº¦æ•°ç»„ - å°±åƒå›ºå®šå¤§å°çš„åœè½¦åœº
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint</span>[<span style="color:#ae81ff">3</span>] <span style="color:#66d9ef">public</span> parkingLot <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>];
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// åŠ¨æ€é•¿åº¦æ•°ç»„ - å°±åƒå¯ä»¥éšæ—¶æ‰©å»ºçš„ä»“åº“
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint</span>[] <span style="color:#66d9ef">public</span> warehouse;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æ·»åŠ å•†å“åˆ°ä»“åº“
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">addItem</span>(<span style="color:#66d9ef">uint</span> item) <span style="color:#66d9ef">public</span> {
</span></span><span style="display:flex;"><span>        warehouse.push(item);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ç§»é™¤æœ€åä¸€ä¸ªå•†å“
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">removeLastItem</span>() <span style="color:#66d9ef">public</span> {
</span></span><span style="display:flex;"><span>        require(warehouse.length <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#34;Warehouse is empty&#34;</span>);
</span></span><span style="display:flex;"><span>        warehouse.pop();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// è·å–ä»“åº“ä¸­çš„å•†å“æ•°é‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getItemCount</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">view</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> warehouse.length;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æ¸…ç©ºæ•´ä¸ªä»“åº“
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">clearWarehouse</span>() <span style="color:#66d9ef">public</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">delete</span> warehouse;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><blockquote>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li>æ•°ç»„çš„é•¿åº¦ä¸èƒ½è¶…è¿‡ 2^256-1</li>
<li>åˆ é™¤æ•°ç»„å…ƒç´ ä¸ä¼šæ”¹å˜æ•°ç»„é•¿åº¦</li>
<li>memory æ•°ç»„ä¸èƒ½ä½¿ç”¨ push() æ–¹æ³•</li>
<li>è®¿é—®è¶…å‡ºæ•°ç»„èŒƒå›´çš„ç´¢å¼•ä¼šå¯¼è‡´å¼‚å¸¸</li>
</ol>
</blockquote>
<h4 id="heading-9">å­—ç¬¦ä¸²</h4>
<p>å­—ç¬¦ä¸²ç”¨äºå­˜å‚¨æ–‡æœ¬æ•°æ®ã€‚åœ¨æ™ºèƒ½åˆçº¦ä¸­ï¼Œå­—ç¬¦ä¸²å¸¸ç”¨äºå­˜å‚¨åç§°ã€æè¿°ã€æ¶ˆæ¯ç­‰æ–‡æœ¬ä¿¡æ¯ã€‚</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">StringExample</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">string</span> <span style="color:#66d9ef">public</span> name;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constructor</span>(<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span> _name) {
</span></span><span style="display:flex;"><span>        name <span style="color:#f92672">=</span> _name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å­—ç¬¦ä¸²è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">greet</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">view</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">string</span>.concat(<span style="color:#e6db74">&#34;Hello, &#34;</span>, name, <span style="color:#e6db74">&#34;!&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// è·å–å­—ç¬¦ä¸²é•¿åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getNameLength</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">view</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">bytes</span>(name).length;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æ”¯æŒ unicode (æ¯”å¦‚ä¸­æ–‡ã€è¡¨æƒ…ç¬¦å·)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">greetInChinese</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> unicode<span style="color:#e6db74">&#34;ä½ å¥½ï¼Œä¸–ç•Œï¼ğŸ‘‹&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><blockquote>
<p>å°è´´å£«ï¼š</p>
<ol>
<li>å­—ç¬¦ä¸²æ¯”è¾ƒéœ€è¦å…ˆè½¬æ¢ä¸º bytes å†ç”¨ keccak256 è®¡ç®—å“ˆå¸Œå€¼</li>
<li>å­—ç¬¦ä¸²æ“ä½œç›¸å¯¹è€—è´¹ gasï¼Œå°½é‡ä½¿ç”¨è¾ƒçŸ­çš„å­—ç¬¦ä¸²</li>
<li>å¦‚æœåªæ˜¯å­˜å‚¨å›ºå®šçš„çŸ­æ–‡æœ¬ï¼Œè€ƒè™‘ä½¿ç”¨ bytes32 ä»£æ›¿ string</li>
</ol>
</blockquote>
<h4 id="heading-10">æ˜ å°„</h4>
<p>mapping å°±åƒä¸€ä¸ªç¥å¥‡çš„å­—å…¸ï¼Œä½ ç»™å®ƒä¸€ä¸ªå…³é”®è¯(key)ï¼Œå®ƒå°±èƒ½ç«‹å³æ‰¾åˆ°å¯¹åº”çš„å†…å®¹(value)ã€‚éå¸¸é€‚åˆéœ€è¦å¿«é€ŸæŸ¥æ‰¾çš„åœºæ™¯ï¼Œæ¯”å¦‚ç”¨æˆ·ä½™é¢ã€æŠ•ç¥¨è®°å½•ç­‰ã€‚</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">VotingSystem</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// è®°å½•æ¯ä¸ªåœ°å€çš„æŠ•ç¥¨æƒé‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">address</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">uint</span>) <span style="color:#66d9ef">public</span> voteWeight;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// è®°å½•æ¯ä¸ªææ¡ˆçš„å¾—ç¥¨æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">uint</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">uint</span>) <span style="color:#66d9ef">public</span> proposalVotes;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// è®°å½•æ¯ä¸ªåœ°å€å¯¹æ¯ä¸ªææ¡ˆçš„æŠ•ç¥¨æƒ…å†µ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">address</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">uint</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">bool</span>)) <span style="color:#66d9ef">public</span> hasVoted;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// åˆ†é…æŠ•ç¥¨æƒé‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">assignVoteWeight</span>(<span style="color:#66d9ef">address</span> voter, <span style="color:#66d9ef">uint</span> weight) <span style="color:#66d9ef">public</span> {
</span></span><span style="display:flex;"><span>        voteWeight[voter] <span style="color:#f92672">=</span> weight;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æŠ•ç¥¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">vote</span>(<span style="color:#66d9ef">uint</span> proposalId) <span style="color:#66d9ef">public</span> {
</span></span><span style="display:flex;"><span>        require(<span style="color:#f92672">!</span>hasVoted[msg.sender][proposalId], <span style="color:#e6db74">&#34;Already voted&#34;</span>);
</span></span><span style="display:flex;"><span>        require(voteWeight[msg.sender] <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#34;No voting rights&#34;</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        proposalVotes[proposalId] <span style="color:#f92672">+=</span> voteWeight[msg.sender];
</span></span><span style="display:flex;"><span>        hasVoted[msg.sender][proposalId] <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><h3 id="heading-11">å¸¸é‡</h3>
<p>åœ¨ Solidity ä¸­ï¼Œå¸¸é‡å°±åƒæ˜¯å†™åœ¨çŸ³å¤´ä¸Šçš„æ•°å­—ï¼Œä¸€æ—¦ç¡®å®šå°±æ°¸è¿œä¸ä¼šæ”¹å˜ã€‚ä½¿ç”¨å¸¸é‡ä¸ä»…å¯ä»¥è®©ä»£ç æ›´å®‰å…¨ï¼Œè¿˜èƒ½èŠ‚çœ gas è´¹ç”¨ã€‚Solidity æä¾›äº†ä¸¤ç§ç±»å‹çš„å¸¸é‡ï¼šconstantï¼ˆç¼–è¯‘æ—¶å¸¸é‡ï¼‰å’Œ immutableï¼ˆä¸å¯å˜é‡ï¼‰ã€‚</p>
<h4 id="constant">constant</h4>
<p>constant å¸¸é‡å¿…é¡»åœ¨å£°æ˜æ—¶å°±ç¡®å®šå®ƒçš„å€¼ï¼Œå°±åƒæŠŠæ•°å­—åˆ»åœ¨çŸ³å¤´ä¸Šä¸€æ ·ï¼Œä¹‹åå°±å†ä¹Ÿæ”¹ä¸äº†äº†ã€‚å®ƒé€šå¸¸ç”¨äºå®šä¹‰ä¸€äº›å›ºå®šçš„é…ç½®å€¼ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>æœ€å¤§ä¾›åº”é‡</li>
<li>è´¹ç‡ç™¾åˆ†æ¯”</li>
<li>æ—¶é—´é—´éš”</li>
<li>åˆçº¦ç‰ˆæœ¬å·</li>
</ul>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">TokenConfig</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ä»£å¸çš„åŸºæœ¬é…ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">string</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">constant</span> NAME <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;MyToken&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">string</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">constant</span> SYMBOL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;MTK&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint8</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">constant</span> DECIMALS <span style="color:#f92672">=</span> <span style="color:#ae81ff">18</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">constant</span> TOTAL_SUPPLY <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000000</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">10</span><span style="color:#f92672">**</span><span style="color:#ae81ff">18</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// è´¹ç‡è®¾ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">constant</span> TRANSFER_FEE <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>;  <span style="color:#75715e">// 0.1%
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">constant</span> MAX_FEE <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span>;      <span style="color:#75715e">// 1%
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æ—¶é—´å¸¸é‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">constant</span> LOCK_PERIOD <span style="color:#f92672">=</span> <span style="color:#ae81ff">365</span> <span style="color:#66d9ef">days</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">constant</span> MIN_STAKE_TIME <span style="color:#f92672">=</span> <span style="color:#ae81ff">7</span> <span style="color:#66d9ef">days</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><blockquote>
<p>ä½¿ç”¨å»ºè®®ï¼š</p>
<ol>
<li>å¯¹äºæ°¸è¿œä¸ä¼šæ”¹å˜çš„é…ç½®å€¼ï¼Œä¼˜å…ˆä½¿ç”¨ constant</li>
<li>constant å˜é‡åé€šå¸¸ä½¿ç”¨å¤§å†™å­—æ¯</li>
<li>å¤æ‚çš„è¡¨è¾¾å¼ä¹Ÿå¯ä»¥ç”¨ constantï¼Œåªè¦èƒ½åœ¨ç¼–è¯‘æ—¶è®¡ç®—å‡ºç»“æœ</li>
</ol>
</blockquote>
<h4 id="immutable">immutable</h4>
<p>immutableï¼ˆä¸å¯å˜é‡ï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¸¸é‡ï¼Œå®ƒçš„å€¼å¯ä»¥åœ¨åˆçº¦éƒ¨ç½²æ—¶è®¾ç½®ï¼Œä½†ä¹‹åå°±ä¸èƒ½å†æ”¹å˜äº†ã€‚è¿™éå¸¸é€‚åˆé‚£äº›éœ€è¦åœ¨éƒ¨ç½²æ—¶æ‰èƒ½ç¡®å®šçš„å€¼ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>åˆçº¦æ‰€æœ‰è€…åœ°å€</li>
<li>åˆå§‹æ—¶é—´æˆ³</li>
<li>å…¶ä»–åˆçº¦çš„åœ°å€</li>
<li>åˆå§‹é…ç½®å‚æ•°</li>
</ul>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">TokenSale</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// åœ¨éƒ¨ç½²æ—¶éœ€è¦ç¡®å®šçš„å…³é”®åœ°å€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">address</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">immutable</span> owner;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">address</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">immutable</span> tokenAddress;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">address</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">immutable</span> treasuryWallet;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// åœ¨éƒ¨ç½²æ—¶éœ€è¦ç¡®å®šçš„å‚æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">immutable</span> startTime;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">immutable</span> pricePerToken;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">immutable</span> maxBuyPerUser;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constructor</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">address</span> _token,
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">address</span> _treasury,
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> _price,
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> _maxBuy
</span></span><span style="display:flex;"><span>    ) {
</span></span><span style="display:flex;"><span>        owner <span style="color:#f92672">=</span> msg.sender;
</span></span><span style="display:flex;"><span>        tokenAddress <span style="color:#f92672">=</span> _token;
</span></span><span style="display:flex;"><span>        treasuryWallet <span style="color:#f92672">=</span> _treasury;
</span></span><span style="display:flex;"><span>        startTime <span style="color:#f92672">=</span> block.timestamp;
</span></span><span style="display:flex;"><span>        pricePerToken <span style="color:#f92672">=</span> _price;
</span></span><span style="display:flex;"><span>        maxBuyPerUser <span style="color:#f92672">=</span> _maxBuy;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å…¶ä»–å‡½æ•°...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre><blockquote>
<p>é‡è¦æç¤ºï¼š</p>
<ol>
<li>immutable å˜é‡åªèƒ½åœ¨æ„é€ å‡½æ•°ä¸­èµ‹å€¼ä¸€æ¬¡</li>
<li>èµ‹å€¼åå°±ä¸èƒ½å†ä¿®æ”¹</li>
<li>é€‚åˆå­˜å‚¨éƒ¨ç½²æ—¶æ‰èƒ½ç¡®å®šçš„é…ç½®</li>
<li>æ¯”æ™®é€šçŠ¶æ€å˜é‡æ›´çœ gas</li>
</ol>
</blockquote>
<h4 id="constant-vs-immutable-">constant vs immutable å¦‚ä½•é€‰æ‹©ï¼Ÿ</h4>
<ol>
<li>
<p>å¦‚æœå€¼åœ¨å†™ä»£ç æ—¶å°±èƒ½ç¡®å®šï¼Œä½¿ç”¨ constant</p>
<ul>
<li>ä»£å¸å°æ•°ä½æ•°</li>
<li>æœ€å¤§ä¾›åº”é‡</li>
<li>å›ºå®šçš„æ—¶é—´é—´éš”</li>
</ul>
</li>
<li>
<p>å¦‚æœå€¼éœ€è¦åœ¨éƒ¨ç½²æ—¶æ‰èƒ½ç¡®å®šï¼Œä½¿ç”¨ immutable</p>
<ul>
<li>éƒ¨ç½²æ—¶é—´</li>
<li>åˆçº¦åœ°å€</li>
<li>åˆå§‹æ‰€æœ‰è€…</li>
<li>å…¶ä»–ä¾èµ–éƒ¨ç½²ç¯å¢ƒçš„å‚æ•°</li>
</ul>
</li>
</ol>
<hr />
<h2 id="heading-12">å‡½æ•°</h2>
<p>å‡½æ•°å°±åƒæ˜¯åˆçº¦çš„&quot;åŠ¨ä½œ&quot;éƒ¨åˆ†â€”â€”å¦‚æœè¯´çŠ¶æ€å˜é‡æ˜¯åˆçº¦çš„&quot;è®°å¿†&quot;ï¼Œé‚£ä¹ˆå‡½æ•°å°±æ˜¯åˆçº¦çš„&quot;è¡Œä¸º&quot;ã€‚æ¯ä¸ªå‡½æ•°éƒ½æœ‰ç‰¹å®šçš„åŠŸèƒ½ï¼Œå°±åƒé¤å…é‡Œä¸åŒçš„å·¥ä½œäººå‘˜å„å¸å…¶èŒï¼šæœ‰äººè´Ÿè´£æ¥å¾…ï¼Œæœ‰äººè´Ÿè´£æ”¶é“¶ï¼Œæœ‰äººè´Ÿè´£çƒ¹é¥ªã€‚</p>
<h3 id="heading-13">å‡½æ•°å®šä¹‰</h3>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä»£å¸åˆçº¦æ¥äº†è§£ä¸åŒç±»å‹çš„å‡½æ•°ï¼š</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">TokenContract</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// çŠ¶æ€å˜é‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">address</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">uint</span>) <span style="color:#66d9ef">public</span> balances;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">address</span> <span style="color:#66d9ef">public</span> owner;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æ„é€ å‡½æ•°ï¼šåˆçº¦éƒ¨ç½²æ—¶è‡ªåŠ¨æ‰§è¡Œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">constructor</span>() {
</span></span><span style="display:flex;"><span>        owner <span style="color:#f92672">=</span> msg.sender;
</span></span><span style="display:flex;"><span>        balances[msg.sender] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000000</span>; <span style="color:#75715e">// åˆå§‹å‘è¡Œ100ä¸‡ä»£å¸
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// åŸºç¡€è½¬è´¦å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">transfer</span>(<span style="color:#66d9ef">address</span> to, <span style="color:#66d9ef">uint</span> amount) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>        require(balances[msg.sender] <span style="color:#f92672">&gt;=</span> amount, <span style="color:#e6db74">&#34;Insufficient balance&#34;</span>);
</span></span><span style="display:flex;"><span>        require(to <span style="color:#f92672">!=</span> <span style="color:#66d9ef">address</span>(<span style="color:#ae81ff">0</span>), <span style="color:#e6db74">&#34;Invalid recipient&#34;</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        balances[msg.sender] <span style="color:#f92672">-=</span> amount;
</span></span><span style="display:flex;"><span>        balances[to] <span style="color:#f92672">+=</span> amount;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// è§¦å‘è½¬è´¦äº‹ä»¶ï¼ˆåé¢ä¼šè®²åˆ°äº‹ä»¶ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        emit Transfer(msg.sender, to, amount);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// åªè¯»å‡½æ•°ï¼šæŸ¥è¯¢ä½™é¢
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getBalance</span>(<span style="color:#66d9ef">address</span> account) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">view</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> balances[account];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// çº¯å‡½æ•°ï¼šè®¡ç®—ä»£å¸æ•°é‡ï¼ˆæ¯”å¦‚æ ¹æ®ETHè®¡ç®—å¯ä»¥ä¹°å¤šå°‘ä»£å¸ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">calculateTokenAmount</span>(<span style="color:#66d9ef">uint</span> ethAmount) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 1 ETH = 1000 tokens
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span> ethAmount <span style="color:#f92672">*</span> <span style="color:#ae81ff">1000</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æ¥æ”¶ETHçš„å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    receive() <span style="color:#66d9ef">external</span> <span style="color:#66d9ef">payable</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// å½“åˆçº¦æ”¶åˆ°ETHæ—¶è‡ªåŠ¨æ‰§è¡Œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">uint</span> tokenAmount <span style="color:#f92672">=</span> calculateTokenAmount(msg.value);
</span></span><span style="display:flex;"><span>        balances[msg.sender] <span style="color:#f92672">+=</span> tokenAmount;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ç®¡ç†å‘˜å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">mint</span>(<span style="color:#66d9ef">address</span> to, <span style="color:#66d9ef">uint</span> amount) <span style="color:#66d9ef">public</span> {
</span></span><span style="display:flex;"><span>        require(msg.sender <span style="color:#f92672">==</span> owner, <span style="color:#e6db74">&#34;Only owner can mint&#34;</span>);
</span></span><span style="display:flex;"><span>        balances[to] <span style="color:#f92672">+=</span> amount;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><h3 id="heading-14">å‡½æ•°å¯è§æ€§</h3>
<p>å‡½æ•°çš„å¯è§æ€§å°±åƒæ˜¯ç»™å‡½æ•°è®¾ç½®&quot;è®¿é—®æƒé™&quot;ã€‚å°±åƒä¸€ä¸ªå»ºç­‘ç‰©ï¼Œæœ‰çš„åŒºåŸŸå¯¹æ‰€æœ‰äººå¼€æ”¾ï¼Œæœ‰çš„åªå¯¹å‘˜å·¥å¼€æ”¾ï¼Œæœ‰çš„åªå¯¹ç®¡ç†å‘˜å¼€æ”¾ã€‚</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">AccessControl</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 1. publicï¼šå¯¹æ‰€æœ‰äººå¼€æ”¾ï¼Œå°±åƒå•†åœºçš„å¤§é—¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">publicFunction</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Anyone can call me&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 2. privateï¼šåªèƒ½ä»åˆçº¦å†…éƒ¨è°ƒç”¨ï¼Œå°±åƒå‘˜å·¥ä¼‘æ¯å®¤
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">privateFunction</span>() <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Only this contract can call me&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 3. internalï¼šåªèƒ½ä»å½“å‰åˆçº¦å’Œå­åˆçº¦è°ƒç”¨ï¼Œå°±åƒå‘˜å·¥åŠå…¶å®¶å±ä¸“ç”¨åŒº
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">internalFunction</span>() <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;This contract and its children can call me&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 4. externalï¼šåªèƒ½ä»å¤–éƒ¨è°ƒç”¨ï¼Œä¸èƒ½ä»åˆçº¦å†…éƒ¨è°ƒç”¨ï¼Œå°±åƒå¯¹å¤–æœåŠ¡çª—å£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">externalFunction</span>() <span style="color:#66d9ef">external</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Only external calls allowed&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æµ‹è¯•å‡½æ•°å¯è§æ€§
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">testVisibility</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">view</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// å¯ä»¥è°ƒç”¨ public å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        this.publicFunction();  <span style="color:#75715e">// ä½¿ç”¨ this æ˜¯å¤–éƒ¨è°ƒç”¨ï¼Œæ¶ˆè€—æ›´å¤š gas
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        publicFunction();       <span style="color:#75715e">// å†…éƒ¨è°ƒç”¨ï¼Œæ›´çœ gas
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// å¯ä»¥è°ƒç”¨ private å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        privateFunction();
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// å¯ä»¥è°ƒç”¨ internal å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        internalFunction();
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ä¸èƒ½ç›´æ¥è°ƒç”¨ external å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// externalFunction();  // è¿™è¡Œä¼šç¼–è¯‘é”™è¯¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        this.externalFunction();  <span style="color:#75715e">// å¿…é¡»é€šè¿‡ this è°ƒç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><p>å°è´´å£«ï¼š</p>
<ol>
<li>public å‡½æ•°ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåŒåçš„ getter å‡½æ•°</li>
<li>external å‡½æ•°æ¯” public å‡½æ•°æ›´çœ gasï¼ˆå½“ä»å¤–éƒ¨è°ƒç”¨æ—¶ï¼‰</li>
<li>å¦‚æœå‡½æ•°åªä¼šä»å¤–éƒ¨è°ƒç”¨ï¼Œå»ºè®®ä½¿ç”¨ external</li>
<li>å¦‚æœä¸ç¡®å®šç”¨å“ªä¸ªï¼Œpublic æ˜¯æœ€å®‰å…¨çš„é€‰æ‹©</li>
</ol>
<h3 id="heading-15">å‡½æ•°ä¿®é¥°ç¬¦</h3>
<p>å‡½æ•°ä¿®é¥°ç¬¦ç”¨äºå£°æ˜å‡½æ•°çš„ç‰¹æ€§ï¼Œå°±åƒç»™å‡½æ•°è´´ä¸Šä¸åŒçš„æ ‡ç­¾ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨è¿™ä¸ªå‡½æ•°æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼š</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">ModifierExample</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> counter <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 1. viewï¼šå¯ä»¥è¯»å–çŠ¶æ€ï¼Œä½†ä¸èƒ½ä¿®æ”¹çŠ¶æ€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getCounter</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">view</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> counter;  <span style="color:#75715e">// åªè¯»å–çŠ¶æ€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 2. pureï¼šä¸èƒ½è¯»å–ä¹Ÿä¸èƒ½ä¿®æ”¹çŠ¶æ€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">uint</span> a, <span style="color:#66d9ef">uint</span> b) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> a <span style="color:#f92672">+</span> b;  <span style="color:#75715e">// çº¯è®¡ç®—
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 3. payableï¼šå¯ä»¥æ¥æ”¶ ETH
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">deposit</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">payable</span> {
</span></span><span style="display:flex;"><span>        counter <span style="color:#f92672">+=</span> msg.value;  <span style="color:#75715e">// è®°å½•å­˜å…¥çš„ ETH æ•°é‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 4. ä¸å¸¦ä¿®é¥°ç¬¦ï¼šå¯ä»¥ä¿®æ”¹çŠ¶æ€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">increment</span>() <span style="color:#66d9ef">public</span> {
</span></span><span style="display:flex;"><span>        counter <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>;  <span style="color:#75715e">// ä¿®æ”¹çŠ¶æ€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><p>å°è´´å£«ï¼š</p>
<ol>
<li>ä¼˜å…ˆä½¿ç”¨ pure å’Œ viewï¼Œå› ä¸ºå®ƒä»¬ä¸æ¶ˆè€— gasï¼ˆä»å¤–éƒ¨è°ƒç”¨æ—¶ï¼‰</li>
<li>å¦‚æœå‡½æ•°éœ€è¦ä¿®æ”¹çŠ¶æ€ï¼Œå°±ä¸è¦åŠ è¿™äº›ä¿®é¥°ç¬¦</li>
<li>payable å‡½æ•°è¦ç‰¹åˆ«æ³¨æ„å®‰å…¨æ€§ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥æ¥æ”¶ ETH</li>
</ol>
<h3 id="heading-16">ç‰¹æ®Šå‡½æ•°</h3>
<p>Solidity æä¾›äº†ä¸€äº›ç‰¹æ®Šå‡½æ•°ï¼Œå®ƒä»¬åœ¨ç‰¹å®šæƒ…å†µä¸‹ä¼šè‡ªåŠ¨æ‰§è¡Œï¼š</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">SpecialFunctions</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">event</span> <span style="color:#a6e22e">Received</span>(<span style="color:#66d9ef">address</span> sender, <span style="color:#66d9ef">uint</span> amount);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">event</span> <span style="color:#a6e22e">FallbackCalled</span>(<span style="color:#66d9ef">address</span> sender, <span style="color:#66d9ef">bytes</span> data);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 1. æ„é€ å‡½æ•°ï¼šåªåœ¨åˆçº¦éƒ¨ç½²æ—¶æ‰§è¡Œä¸€æ¬¡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">constructor</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// åˆå§‹åŒ–ä»£ç 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 2. receive å‡½æ•°ï¼šå½“åˆçº¦æ”¶åˆ° ETH æ—¶è‡ªåŠ¨æ‰§è¡Œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    receive() <span style="color:#66d9ef">external</span> <span style="color:#66d9ef">payable</span> {
</span></span><span style="display:flex;"><span>        emit Received(msg.sender, msg.value);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 3. fallback å‡½æ•°ï¼šå½“è°ƒç”¨çš„å‡½æ•°ä¸å­˜åœ¨æ—¶æ‰§è¡Œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    fallback() <span style="color:#66d9ef">external</span> <span style="color:#66d9ef">payable</span> {
</span></span><span style="display:flex;"><span>        emit FallbackCalled(msg.sender, msg.data);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li>ä¸€ä¸ªåˆçº¦åªèƒ½æœ‰ä¸€ä¸ª constructor</li>
<li>receive å‡½æ•°å¿…é¡»æ˜¯ external payable</li>
<li>fallback å‡½æ•°ä¼šåœ¨ä»¥ä¸‹æƒ…å†µè¢«è°ƒç”¨ï¼š
<ul>
<li>è°ƒç”¨ä¸å­˜åœ¨çš„å‡½æ•°</li>
<li>ç›´æ¥å‘é€ ETH ä½†æ²¡æœ‰ receive å‡½æ•°</li>
<li>å‘é€çš„æ•°æ®ä¸æ˜¯æœ‰æ•ˆçš„å‡½æ•°è°ƒç”¨</li>
</ul>
</li>
</ol>
<h3 id="heading-17">å‡½æ•°é‡è½½</h3>
<p>Solidity æ”¯æŒå‡½æ•°é‡è½½ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥å®šä¹‰å¤šä¸ªåŒåä½†å‚æ•°ä¸åŒçš„å‡½æ•°ã€‚å°±åƒé¤å…çš„å¨å¸ˆå¯ä»¥ç”¨ä¸åŒçš„é…æ–™åšå‡ºåŒåçš„èœå“ï¼š</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">FunctionOverloading</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// è½¬è´¦ç›¸å…³å‡½æ•°çš„é‡è½½ç¤ºä¾‹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 1. åŸºç¡€è½¬è´¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">transfer</span>(<span style="color:#66d9ef">address</span> to, <span style="color:#66d9ef">uint</span> amount) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ... åŸºç¡€è½¬è´¦é€»è¾‘
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 2. å¸¦å¤‡æ³¨çš„è½¬è´¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">transfer</span>(<span style="color:#66d9ef">address</span> to, <span style="color:#66d9ef">uint</span> amount, <span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span> note) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ... å¸¦å¤‡æ³¨çš„è½¬è´¦é€»è¾‘
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        emit Transfer(msg.sender, to, amount, note);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 3. æ‰¹é‡è½¬è´¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">transfer</span>(<span style="color:#66d9ef">address</span>[] <span style="color:#66d9ef">memory</span> to, <span style="color:#66d9ef">uint</span>[] <span style="color:#66d9ef">memory</span> amounts) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>        require(to.length <span style="color:#f92672">==</span> amounts.length, <span style="color:#e6db74">&#34;Arrays length mismatch&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ... æ‰¹é‡è½¬è´¦é€»è¾‘
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li>é‡è½½å‡½æ•°å¿…é¡»æœ‰ä¸åŒçš„å‚æ•°ç±»å‹</li>
<li>ä»…è¿”å›å€¼ä¸åŒä¸æ„æˆé‡è½½</li>
<li>å‚æ•°åç§°ä¸åŒä¸æ„æˆé‡è½½</li>
</ol>
<hr />
<h2 id="heading-18">ç¨‹åºæ§åˆ¶</h2>
<p>å°±åƒæŒ‡æŒ¥äº¤é€šçš„çº¢ç»¿ç¯ï¼Œç¨‹åºæ§åˆ¶ç»“æ„å¸®åŠ©æˆ‘ä»¬ç®¡ç†ä»£ç çš„æ‰§è¡Œæµç¨‹ã€‚Solidity æä¾›äº†å‡ ç§åŸºæœ¬çš„æ§åˆ¶ç»“æ„ï¼Œè®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ª NFT äº¤æ˜“å¸‚åœºçš„ä¾‹å­æ¥ç†è§£å®ƒä»¬ï¼š</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">NFTMarketplace</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// çŠ¶æ€å˜é‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">uint</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">uint</span>) <span style="color:#66d9ef">public</span> nftPrices;      <span style="color:#75715e">// NFT ä»·æ ¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">uint</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">address</span>) <span style="color:#66d9ef">public</span> nftOwners;   <span style="color:#75715e">// NFT æ‰€æœ‰è€…
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">uint</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">bool</span>) <span style="color:#66d9ef">public</span> isListed;       <span style="color:#75715e">// NFT æ˜¯å¦åœ¨å”®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> platformFee <span style="color:#f92672">=</span> <span style="color:#ae81ff">25</span>;                <span style="color:#75715e">// å¹³å°è´¹ç‡ï¼ˆ2.5%ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æ¡ä»¶æ§åˆ¶ç¤ºä¾‹ï¼šä¸Šæ¶ NFT
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">listNFT</span>(<span style="color:#66d9ef">uint</span> tokenId, <span style="color:#66d9ef">uint</span> price) <span style="color:#66d9ef">public</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 1. if-elseï¼šåŸºæœ¬æ¡ä»¶åˆ¤æ–­
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (nftOwners[tokenId] <span style="color:#f92672">!=</span> msg.sender) {
</span></span><span style="display:flex;"><span>            revert(<span style="color:#e6db74">&#34;Not the owner&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 2. å¤šé‡æ¡ä»¶ï¼šæ£€æŸ¥ä»·æ ¼å’ŒçŠ¶æ€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (price <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>            revert(<span style="color:#e6db74">&#34;Price cannot be zero&#34;</span>);
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (isListed[tokenId]) {
</span></span><span style="display:flex;"><span>            revert(<span style="color:#e6db74">&#34;Already listed&#34;</span>);
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (price <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">100</span> <span style="color:#66d9ef">ether</span>) {
</span></span><span style="display:flex;"><span>            revert(<span style="color:#e6db74">&#34;Price too high&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// è®¾ç½® NFT ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        nftPrices[tokenId] <span style="color:#f92672">=</span> price;
</span></span><span style="display:flex;"><span>        isListed[tokenId] <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å¾ªç¯ç¤ºä¾‹ï¼šæ‰¹é‡å¤„ç† NFT
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">batchList</span>(<span style="color:#66d9ef">uint</span>[] calldata tokenIds, <span style="color:#66d9ef">uint</span>[] calldata prices) <span style="color:#66d9ef">public</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 3. for å¾ªç¯ï¼šæ‰¹é‡ä¸Šæ¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        require(tokenIds.length <span style="color:#f92672">==</span> prices.length, <span style="color:#e6db74">&#34;Length mismatch&#34;</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">uint</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> tokenIds.length; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// è¿™é‡Œå¯ä»¥è°ƒç”¨ listNFTï¼Œä½†ç›´æ¥å¤„ç†æ›´çœ gas
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">uint</span> tokenId <span style="color:#f92672">=</span> tokenIds[i];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">uint</span> price <span style="color:#f92672">=</span> prices[i];
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            require(nftOwners[tokenId] <span style="color:#f92672">==</span> msg.sender, <span style="color:#e6db74">&#34;Not the owner&#34;</span>);
</span></span><span style="display:flex;"><span>            require(price <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#34;Invalid price&#34;</span>);
</span></span><span style="display:flex;"><span>            require(<span style="color:#f92672">!</span>isListed[tokenId], <span style="color:#e6db74">&#34;Already listed&#34;</span>);
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            nftPrices[tokenId] <span style="color:#f92672">=</span> price;
</span></span><span style="display:flex;"><span>            isListed[tokenId] <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// while å¾ªç¯ç¤ºä¾‹ï¼šæŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¯è´­ä¹°çš„ NFT
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">findFirstListedNFT</span>(<span style="color:#66d9ef">uint</span> startId, <span style="color:#66d9ef">uint</span> endId) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">view</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span> foundId, <span style="color:#66d9ef">bool</span> found) 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 4. while å¾ªç¯ï¼šåœ¨èŒƒå›´å†…æœç´¢
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">uint</span> currentId <span style="color:#f92672">=</span> startId;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (currentId <span style="color:#f92672">&lt;=</span> endId) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (isListed[currentId]) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> (currentId, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            currentId<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> (<span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// do-while å¾ªç¯ç¤ºä¾‹ï¼šæ‹å–å€’è®¡æ—¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">startAuction</span>(<span style="color:#66d9ef">uint</span> tokenId, <span style="color:#66d9ef">uint</span> duration) <span style="color:#66d9ef">public</span> {
</span></span><span style="display:flex;"><span>        require(isListed[tokenId], <span style="color:#e6db74">&#34;NFT not listed&#34;</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 5. do-whileï¼šè‡³å°‘æ‰§è¡Œä¸€æ¬¡çš„å¾ªç¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">uint</span> timeLeft <span style="color:#f92672">=</span> duration;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// åœ¨å®é™…åœºæ™¯ä¸­ï¼Œè¿™é‡Œä¼šç­‰å¾…ä¸€æ®µæ—¶é—´
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            timeLeft<span style="color:#f92672">--</span>;
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// æ£€æŸ¥æ˜¯å¦æœ‰æ–°çš„å‡ºä»·
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span> (hasNewBid(tokenId)) {
</span></span><span style="display:flex;"><span>                timeLeft <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span> <span style="color:#66d9ef">minutes</span>; <span style="color:#75715e">// é‡ç½®å€’è®¡æ—¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">while</span> (timeLeft <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// æ‹å–ç»“æŸï¼Œå¤„ç†ç»“æœ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        finalizeAuction(tokenId);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// è¾…åŠ©å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">hasNewBid</span>(<span style="color:#66d9ef">uint</span> tokenId) <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// å®ç°æ£€æŸ¥æ–°å‡ºä»·çš„é€»è¾‘
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">finalizeAuction</span>(<span style="color:#66d9ef">uint</span> tokenId) <span style="color:#66d9ef">internal</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// å®ç°æ‹å–ç»“æŸçš„é€»è¾‘
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><h3 id="heading-19">é”™è¯¯å¤„ç†æœ€ä½³å®è·µ</h3>
<p>åœ¨ä½¿ç”¨æ§åˆ¶ç»“æ„æ—¶ï¼Œåˆç†çš„é”™è¯¯å¤„ç†éå¸¸é‡è¦ï¼š</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">ErrorHandling</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 1. ä½¿ç”¨ require è¿›è¡Œè¾“å…¥éªŒè¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">validateInput</span>(<span style="color:#66d9ef">uint</span> value) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>        require(value <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#34;Value must be positive&#34;</span>);
</span></span><span style="display:flex;"><span>        require(value <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">100</span>, <span style="color:#e6db74">&#34;Value must be &lt;= 100&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 2. ä½¿ç”¨ if-revert å¤„ç†å¤æ‚æ¡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">complexValidation</span>(<span style="color:#66d9ef">uint</span> value, <span style="color:#66d9ef">bool</span> condition) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (value <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span> <span style="color:#f92672">!</span>condition) {
</span></span><span style="display:flex;"><span>            revert(<span style="color:#e6db74">&#34;Invalid input&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (value <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">100</span> <span style="color:#f92672">&amp;&amp;</span> condition) {
</span></span><span style="display:flex;"><span>            revert(<span style="color:#e6db74">&#34;Value too high with condition&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 3. ä½¿ç”¨ try-catch å¤„ç†å¤–éƒ¨è°ƒç”¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">safeExternalCall</span>(<span style="color:#66d9ef">address</span> target) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> ITarget(target).someFunction() <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">bool</span> success) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> success;
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> Error(<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span> reason) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// å¤„ç†é”™è¯¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            emit ErrorCaught(reason);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><hr />
<h2 id="heading-20">é¢å‘å¯¹è±¡ç‰¹æ€§</h2>
<p>Solidity ä½œä¸ºä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œæä¾›äº†ä¸°å¯Œçš„é¢å‘å¯¹è±¡ç‰¹æ€§ã€‚å°±åƒä¹é«˜ç§¯æœ¨ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™äº›ç‰¹æ€§æ¥ç»„è£…å‡ºå¤æ‚çš„æ™ºèƒ½åˆçº¦ç³»ç»Ÿã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ª DeFi å€Ÿè´·å¹³å°çš„ä¾‹å­æ¥ç†è§£è¿™äº›æ¦‚å¿µï¼š</p>
<h3 id="heading-21">ç»§æ‰¿</h3>
<p>ç»§æ‰¿å°±åƒæ˜¯åˆçº¦çš„&quot;åŸºå› ä¼ é€’&quot;â€”â€”å­åˆçº¦å¯ä»¥ç»§æ‰¿çˆ¶åˆçº¦çš„æ‰€æœ‰ç‰¹æ€§ï¼Œå¹¶ä¸”å¯ä»¥æ·»åŠ æ–°çš„åŠŸèƒ½æˆ–ä¿®æ”¹ç°æœ‰åŠŸèƒ½ã€‚</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#75715e">// åŸºç¡€ä»£å¸åˆçº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">Token</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">address</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">uint</span>) <span style="color:#66d9ef">public</span> balances;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">string</span> <span style="color:#66d9ef">public</span> name;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">string</span> <span style="color:#66d9ef">public</span> symbol;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint8</span> <span style="color:#66d9ef">public</span> decimals;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">event</span> <span style="color:#a6e22e">Transfer</span>(<span style="color:#66d9ef">address</span> <span style="color:#66d9ef">indexed</span> <span style="color:#66d9ef">from</span>, <span style="color:#66d9ef">address</span> <span style="color:#66d9ef">indexed</span> to, <span style="color:#66d9ef">uint</span> amount);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constructor</span>(<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span> _name, <span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span> _symbol) {
</span></span><span style="display:flex;"><span>        name <span style="color:#f92672">=</span> _name;
</span></span><span style="display:flex;"><span>        symbol <span style="color:#f92672">=</span> _symbol;
</span></span><span style="display:flex;"><span>        decimals <span style="color:#f92672">=</span> <span style="color:#ae81ff">18</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">transfer</span>(<span style="color:#66d9ef">address</span> to, <span style="color:#66d9ef">uint</span> amount) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>        require(balances[msg.sender] <span style="color:#f92672">&gt;=</span> amount, <span style="color:#e6db74">&#34;Insufficient balance&#34;</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        balances[msg.sender] <span style="color:#f92672">-=</span> amount;
</span></span><span style="display:flex;"><span>        balances[to] <span style="color:#f92672">+=</span> amount;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        emit Transfer(msg.sender, to, amount);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å¯æš‚åœçš„ä»£å¸åˆçº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">PausableToken</span> <span style="color:#66d9ef">is</span> Token {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">bool</span> <span style="color:#66d9ef">public</span> paused;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">address</span> <span style="color:#66d9ef">public</span> admin;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constructor</span>(<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span> _name, <span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span> _symbol) 
</span></span><span style="display:flex;"><span>        Token(_name, _symbol) 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        admin <span style="color:#f92672">=</span> msg.sender;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// é‡å†™è½¬è´¦å‡½æ•°ï¼Œæ·»åŠ æš‚åœæ£€æŸ¥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">transfer</span>(<span style="color:#66d9ef">address</span> to, <span style="color:#66d9ef">uint</span> amount) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>        require(<span style="color:#f92672">!</span>paused, <span style="color:#e6db74">&#34;Token transfers are paused&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> super.transfer(to, amount);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ç®¡ç†å‘˜åŠŸèƒ½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">togglePause</span>() <span style="color:#66d9ef">public</span> {
</span></span><span style="display:flex;"><span>        require(msg.sender <span style="color:#f92672">==</span> admin, <span style="color:#e6db74">&#34;Only admin&#34;</span>);
</span></span><span style="display:flex;"><span>        paused <span style="color:#f92672">=</span> <span style="color:#f92672">!</span>paused;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å¯å€Ÿè´·çš„ä»£å¸åˆçº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">LendableToken</span> <span style="color:#66d9ef">is</span> PausableToken {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">address</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">uint</span>) <span style="color:#66d9ef">public</span> borrowed;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> interestRate <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>; <span style="color:#75715e">// 5% APR
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constructor</span>(<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span> _name, <span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span> _symbol) 
</span></span><span style="display:flex;"><span>        PausableToken(_name, _symbol) 
</span></span><span style="display:flex;"><span>    {}
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å€Ÿæ¬¾åŠŸèƒ½
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">borrow</span>(<span style="color:#66d9ef">uint</span> amount) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>        require(<span style="color:#f92672">!</span>paused, <span style="color:#e6db74">&#34;Lending is paused&#34;</span>);
</span></span><span style="display:flex;"><span>        require(<span style="color:#66d9ef">address</span>(this).balance <span style="color:#f92672">&gt;=</span> amount, <span style="color:#e6db74">&#34;Insufficient liquidity&#34;</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        borrowed[msg.sender] <span style="color:#f92672">+=</span> amount;
</span></span><span style="display:flex;"><span>        balances[msg.sender] <span style="color:#f92672">+=</span> amount;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        emit Transfer(<span style="color:#66d9ef">address</span>(this), msg.sender, amount);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// è®¡ç®—åˆ©æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">calculateInterest</span>(<span style="color:#66d9ef">address</span> user) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">view</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> (borrowed[user] <span style="color:#f92672">*</span> interestRate) <span style="color:#f92672">/</span> <span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><blockquote>
<p>ç»§æ‰¿çš„æœ€ä½³å®è·µï¼š</p>
<ol>
<li>ä½¿ç”¨ is å…³é”®å­—æ¥ç»§æ‰¿å¤šä¸ªåˆçº¦</li>
<li>ä½¿ç”¨ virtual å’Œ override å…³é”®å­—ç®¡ç†å‡½æ•°é‡å†™</li>
<li>ä½¿ç”¨ super å…³é”®å­—è°ƒç”¨çˆ¶åˆçº¦å‡½æ•°</li>
<li>æ³¨æ„ç»§æ‰¿é¡ºåºï¼ˆä»æœ€åŸºç¡€åˆ°æœ€ç‰¹æ®Šï¼‰</li>
</ol>
</blockquote>
<h3 id="heading-22">æ¥å£</h3>
<p>æ¥å£å°±åƒæ˜¯åˆçº¦ä¹‹é—´çš„&quot;é€šä¿¡åè®®&quot;ï¼Œå®ƒå®šä¹‰äº†åˆçº¦åº”è¯¥å®ç°å“ªäº›åŠŸèƒ½ï¼Œä½†ä¸å…³å¿ƒè¿™äº›åŠŸèƒ½å…·ä½“æ€ä¹ˆå®ç°ã€‚å°±åƒé¤å…çš„èœå•ä¸€æ ·ï¼Œå‘Šè¯‰ä½ æœ‰ä»€ä¹ˆèœï¼Œä½†ä¸ä¼šå‘Šè¯‰ä½ æ€ä¹ˆåšè¿™äº›èœã€‚</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#75715e">// å®šä¹‰å€Ÿè´·åè®®æ¥å£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">ILendingProtocol</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å­˜æ¬¾
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">deposit</span>() <span style="color:#66d9ef">external</span> <span style="color:#66d9ef">payable</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å€Ÿæ¬¾
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">borrow</span>(<span style="color:#66d9ef">uint</span> amount) <span style="color:#66d9ef">external</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">bool</span>);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// è¿˜æ¬¾
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">repay</span>() <span style="color:#66d9ef">external</span> <span style="color:#66d9ef">payable</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æŸ¥è¯¢åˆ©ç‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getInterestRate</span>() <span style="color:#66d9ef">external</span> <span style="color:#66d9ef">view</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æŸ¥è¯¢å¯å€Ÿé¢åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getBorrowLimit</span>(<span style="color:#66d9ef">address</span> user) <span style="color:#66d9ef">external</span> <span style="color:#66d9ef">view</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å¿…é¡»å®šä¹‰çš„äº‹ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">event</span> <span style="color:#a6e22e">Deposit</span>(<span style="color:#66d9ef">address</span> <span style="color:#66d9ef">indexed</span> user, <span style="color:#66d9ef">uint</span> amount);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">event</span> <span style="color:#a6e22e">Borrow</span>(<span style="color:#66d9ef">address</span> <span style="color:#66d9ef">indexed</span> user, <span style="color:#66d9ef">uint</span> amount);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">event</span> <span style="color:#a6e22e">Repay</span>(<span style="color:#66d9ef">address</span> <span style="color:#66d9ef">indexed</span> user, <span style="color:#66d9ef">uint</span> amount);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å®ç°å€Ÿè´·åè®®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">SimpleLending</span> <span style="color:#66d9ef">is</span> ILendingProtocol {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">address</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">uint</span>) <span style="color:#66d9ef">public</span> deposits;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">address</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">uint</span>) <span style="color:#66d9ef">public</span> borrows;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">constant</span> BORROW_FACTOR <span style="color:#f92672">=</span> <span style="color:#ae81ff">80</span>; <span style="color:#75715e">// 80% æŠµæŠ¼ç‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">deposit</span>() <span style="color:#66d9ef">external</span> <span style="color:#66d9ef">payable</span> <span style="color:#66d9ef">override</span> {
</span></span><span style="display:flex;"><span>        deposits[msg.sender] <span style="color:#f92672">+=</span> msg.value;
</span></span><span style="display:flex;"><span>        emit Deposit(msg.sender, msg.value);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">borrow</span>(<span style="color:#66d9ef">uint</span> amount) <span style="color:#66d9ef">external</span> <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> borrowLimit <span style="color:#f92672">=</span> getBorrowLimit(msg.sender);
</span></span><span style="display:flex;"><span>        require(amount <span style="color:#f92672">&lt;=</span> borrowLimit, <span style="color:#e6db74">&#34;Exceeds borrow limit&#34;</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        borrows[msg.sender] <span style="color:#f92672">+=</span> amount;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">payable</span>(msg.sender).transfer(amount);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        emit Borrow(msg.sender, amount);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">repay</span>() <span style="color:#66d9ef">external</span> <span style="color:#66d9ef">payable</span> <span style="color:#66d9ef">override</span> {
</span></span><span style="display:flex;"><span>        require(borrows[msg.sender] <span style="color:#f92672">&gt;=</span> msg.value, <span style="color:#e6db74">&#34;Repay amount too high&#34;</span>);
</span></span><span style="display:flex;"><span>        borrows[msg.sender] <span style="color:#f92672">-=</span> msg.value;
</span></span><span style="display:flex;"><span>        emit Repay(msg.sender, msg.value);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getInterestRate</span>() <span style="color:#66d9ef">external</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">5</span>; <span style="color:#75715e">// 5% APR
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getBorrowLimit</span>(<span style="color:#66d9ef">address</span> user) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">view</span> <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> (deposits[user] <span style="color:#f92672">*</span> BORROW_FACTOR) <span style="color:#f92672">/</span> <span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><blockquote>
<p>æ¥å£ä½¿ç”¨æŠ€å·§ï¼š</p>
<ol>
<li>æ¥å£ä¸­çš„æ‰€æœ‰å‡½æ•°å¿…é¡»æ˜¯ external</li>
<li>æ¥å£ä¸èƒ½å®šä¹‰æ„é€ å‡½æ•°</li>
<li>æ¥å£ä¸èƒ½å®šä¹‰çŠ¶æ€å˜é‡</li>
<li>æ¥å£å¯ä»¥å®šä¹‰äº‹ä»¶</li>
</ol>
</blockquote>
<h3 id="heading-23">æŠ½è±¡åˆçº¦</h3>
<p>æŠ½è±¡åˆçº¦å°±åƒæ˜¯ä¸€ä¸ªåŠæˆå“çš„åˆçº¦æ¨¡æ¿ï¼Œå®ƒå¯ä»¥åŒ…å«å·²å®ç°çš„å‡½æ•°ï¼Œä¹Ÿå¯ä»¥åŒ…å«æœªå®ç°çš„å‡½æ•°ã€‚ç»§æ‰¿å®ƒçš„åˆçº¦å¿…é¡»å®ç°æ‰€æœ‰æœªå®ç°çš„å‡½æ•°ã€‚</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#75715e">// æŠ½è±¡çš„æ”¶ç›Šç‡åˆçº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">YieldStrategy</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å·²å®ç°çš„å‡½æ•°ï¼šè®¡ç®—åŸºç¡€æ”¶ç›Š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">calculateBaseYield</span>(<span style="color:#66d9ef">uint</span> amount) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> amount <span style="color:#f92672">*</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">100</span>; <span style="color:#75715e">// 5% åŸºç¡€æ”¶ç›Š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æœªå®ç°çš„å‡½æ•°ï¼šè®¡ç®—é¢å¤–æ”¶ç›Š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">calculateBonus</span>(<span style="color:#66d9ef">uint</span> amount) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æœªå®ç°çš„å‡½æ•°ï¼šè·å–ç­–ç•¥åç§°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getStrategyName</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">virtual</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å®ç°å…·ä½“çš„æ”¶ç›Šç‡ç­–ç•¥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">StakingStrategy</span> <span style="color:#66d9ef">is</span> YieldStrategy {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å®ç°è®¡ç®—é¢å¤–æ”¶ç›Šçš„å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">calculateBonus</span>(<span style="color:#66d9ef">uint</span> amount) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// æ ¹æ®è´¨æŠ¼é‡‘é¢æä¾›é¢å¤–å¥–åŠ±
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (amount <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">100</span> <span style="color:#66d9ef">ether</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> amount <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">100</span>; <span style="color:#75715e">// é¢å¤– 2%
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å®ç°è·å–ç­–ç•¥åç§°çš„å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getStrategyName</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">string</span> <span style="color:#66d9ef">memory</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;High Yield Staking Strategy&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// è®¡ç®—æ€»æ”¶ç›Š
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">calculateTotalYield</span>(<span style="color:#66d9ef">uint</span> amount) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> calculateBaseYield(amount) <span style="color:#f92672">+</span> calculateBonus(amount);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><blockquote>
<p>æŠ½è±¡åˆçº¦çš„ä½¿ç”¨åœºæ™¯ï¼š</p>
<ol>
<li>å®šä¹‰é€šç”¨çš„ä¸šåŠ¡é€»è¾‘æ¡†æ¶</li>
<li>å¼ºåˆ¶å­åˆçº¦å®ç°ç‰¹å®šåŠŸèƒ½</li>
<li>æä¾›å¯é‡ç”¨çš„åŸºç¡€å®ç°</li>
<li>å®ç°æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼</li>
</ol>
</blockquote>
<hr />
<h2 id="heading-24">é«˜çº§ç‰¹æ€§</h2>
<p>è®©æˆ‘ä»¬é€šè¿‡æ„å»ºä¸€ä¸ª DeFi æ”¶ç›Šèšåˆå™¨(Yield Aggregator)æ¥å­¦ä¹  Solidity çš„é«˜çº§ç‰¹æ€§ã€‚è¿™ä¸ªé¡¹ç›®ä¼šå¸®åŠ©ç”¨æˆ·è‡ªåŠ¨åœ¨ä¸åŒçš„ DeFi åè®®é—´åˆ‡æ¢ï¼Œä»¥è·å–æœ€ä½³æ”¶ç›Šã€‚</p>
<h3 id="modifier">ä¿®é¥°ç¬¦ï¼ˆmodifierï¼‰</h3>
<p>ä¿®é¥°ç¬¦å°±åƒæ˜¯å‡½æ•°çš„&quot;ä¿é•–&quot;ï¼Œå®ƒä»¬åœ¨å‡½æ•°æ‰§è¡Œå‰åè¿›è¡Œå„ç§æ£€æŸ¥å’Œå¤„ç†ã€‚æ¯”å¦‚æ£€æŸ¥è°ƒç”¨è€…æ˜¯å¦æœ‰æƒé™ã€åˆçº¦æ˜¯å¦å¤„äºæ­£ç¡®çŠ¶æ€ç­‰ã€‚</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">YieldAggregator</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">address</span> <span style="color:#66d9ef">public</span> admin;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">bool</span> <span style="color:#66d9ef">public</span> paused;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">mapping</span>(<span style="color:#66d9ef">address</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">uint</span>) <span style="color:#66d9ef">public</span> userDeposits;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> totalDeposits;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> minDepositAmount <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">1</span> <span style="color:#66d9ef">ether</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// åŸºç¡€ä¿®é¥°ç¬¦ï¼šæ£€æŸ¥ç®¡ç†å‘˜æƒé™
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">modifier</span> <span style="color:#a6e22e">onlyAdmin</span>() {
</span></span><span style="display:flex;"><span>        require(msg.sender <span style="color:#f92672">==</span> admin, <span style="color:#e6db74">&#34;Not authorized&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">_</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å¸¦å‚æ•°çš„ä¿®é¥°ç¬¦ï¼šæ£€æŸ¥æœ€å°é‡‘é¢
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">modifier</span> <span style="color:#a6e22e">minAmount</span>(<span style="color:#66d9ef">uint</span> amount) {
</span></span><span style="display:flex;"><span>        require(amount <span style="color:#f92672">&gt;=</span> minDepositAmount, <span style="color:#e6db74">&#34;Amount too small&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">_</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// çŠ¶æ€æ£€æŸ¥ä¿®é¥°ç¬¦ï¼šæ£€æŸ¥åˆçº¦æ˜¯å¦æš‚åœ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">modifier</span> <span style="color:#a6e22e">whenNotPaused</span>() {
</span></span><span style="display:flex;"><span>        require(<span style="color:#f92672">!</span>paused, <span style="color:#e6db74">&#34;Contract is paused&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">_</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å¤åˆä½¿ç”¨ä¿®é¥°ç¬¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">deposit</span>() <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">payable</span> 
</span></span><span style="display:flex;"><span>        whenNotPaused 
</span></span><span style="display:flex;"><span>        minAmount(msg.value) 
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        userDeposits[msg.sender] <span style="color:#f92672">+=</span> msg.value;
</span></span><span style="display:flex;"><span>        totalDeposits <span style="color:#f92672">+=</span> msg.value;
</span></span><span style="display:flex;"><span>        emit Deposit(msg.sender, msg.value);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><blockquote>
<p>ä¿®é¥°ç¬¦ä½¿ç”¨æŠ€å·§ï¼š</p>
<ol>
<li>å°†å¸¸ç”¨çš„æ£€æŸ¥é€»è¾‘å°è£…æˆä¿®é¥°ç¬¦</li>
<li>ä¿®é¥°ç¬¦å¯ä»¥ç»„åˆä½¿ç”¨</li>
<li>æ³¨æ„ä¿®é¥°ç¬¦çš„æ‰§è¡Œé¡ºåº</li>
<li>é¿å…åœ¨ä¿®é¥°ç¬¦ä¸­æ‰§è¡Œå¤æ‚çš„ä¸šåŠ¡é€»è¾‘</li>
</ol>
</blockquote>
<h3 id="event">äº‹ä»¶ï¼ˆeventï¼‰</h3>
<p>äº‹ä»¶å°±åƒæ˜¯åŒºå—é“¾ä¸Šçš„&quot;æ—¥å¿—ç³»ç»Ÿ&quot;ï¼Œå®ƒä¼šæ°¸ä¹…è®°å½•åœ¨åŒºå—é“¾ä¸Šã€‚ä¸æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå¦‚ Kafkaï¼‰ä¸åŒï¼Œäº‹ä»¶ä¸€æ—¦è¢«è®°å½•å°±ä¸å¯æ›´æ”¹ï¼Œä¹Ÿä¸éœ€è¦ç¡®è®¤æ¥æ”¶ã€‚</p>
<h4 id="heading-25">äº‹ä»¶çš„å­˜å‚¨ä½ç½®</h4>
<p>äº‹ä»¶æ•°æ®å­˜å‚¨åœ¨åŒºå—é“¾çš„ç‰¹æ®Šæ•°æ®ç»“æ„ä¸­ï¼Œç§°ä¸º&quot;æ—¥å¿—&quot;ï¼ˆLogsï¼‰ï¼š</p>
<ul>
<li>æ—¥å¿—æ•°æ®ä¸èƒ½è¢«æ™ºèƒ½åˆçº¦è®¿é—®</li>
<li>æ—¥å¿—æ•°æ®å­˜å‚¨æˆæœ¬æ¯”çŠ¶æ€å˜é‡ä½å¾—å¤š</li>
<li>æ—¥å¿—æ•°æ®ä¼šæ°¸ä¹…ä¿å­˜åœ¨åŒºå—é“¾ä¸Š</li>
</ul>
<h4 id="heading-26">äº‹ä»¶çš„æ¥æ”¶æ–¹å¼</h4>
<ol>
<li>å‰ç«¯åº”ç”¨å¯ä»¥é€šè¿‡ Web3 åº“ç›‘å¬äº‹ä»¶ï¼š</li>
</ol>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#75715e">// ç›‘å¬æ‰€æœ‰ Transfer äº‹ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">contract</span>.<span style="color:#a6e22e">events</span>.<span style="color:#a6e22e">Transfer</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;data&#39;</span>, <span style="color:#a6e22e">event</span> =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;è½¬è´¦å‘ç”Ÿï¼š&#39;</span>, {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">from</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">returnValues</span>.<span style="color:#a6e22e">from</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">to</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">returnValues</span>.<span style="color:#a6e22e">to</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">amount</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">returnValues</span>.<span style="color:#a6e22e">amount</span>
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  })
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;error&#39;</span>, <span style="color:#a6e22e">error</span> =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">error</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åªç›‘å¬ç‰¹å®šåœ°å€çš„è½¬è´¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">contract</span>.<span style="color:#a6e22e">events</span>.<span style="color:#a6e22e">Transfer</span>({
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">filter</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">from</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">userAddress</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>})
</span></span></code></pre><ol start="2">
<li>åç«¯æœåŠ¡å¯ä»¥é€šè¿‡ RPC èŠ‚ç‚¹æŸ¥è¯¢å†å²äº‹ä»¶ï¼š</li>
</ol>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#75715e">// è·å–è¿‡å»çš„äº‹ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">events</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">contract</span>.<span style="color:#a6e22e">getPastEvents</span>(<span style="color:#e6db74">&#39;Transfer&#39;</span>, {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fromBlock</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">toBlock</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;latest&#39;</span>
</span></span><span style="display:flex;"><span>});
</span></span></code></pre><h4 id="heading-27">äº‹ä»¶çš„ç‰¹ç‚¹</h4>
<ol>
<li>
<p>ä¸å¯æ¢å¤æ€§ï¼š</p>
<ul>
<li>äº‹ä»¶ä¸€æ—¦å‘å‡ºå°±æ— æ³•æ’¤å›</li>
<li>å¦‚æœäº¤æ˜“å›æ»šï¼Œäº‹ä»¶ä¹Ÿä¸ä¼šè®°å½•</li>
<li>æ²¡æœ‰åŸç”Ÿçš„é‡è¯•æœºåˆ¶ï¼Œå› ä¸ºè¿™æ˜¯æ—¥å¿—è€Œä¸æ˜¯æ¶ˆæ¯é˜Ÿåˆ—</li>
</ul>
</li>
<li>
<p>æ°¸ä¹…å­˜å‚¨ï¼š</p>
<ul>
<li>äº‹ä»¶æ•°æ®ä¼šæ°¸ä¹…ä¿å­˜åœ¨åŒºå—é“¾ä¸Š</li>
<li>å³ä½¿æ²¡æœ‰äººç›‘å¬ï¼Œæ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±</li>
<li>ä»»ä½•æ—¶å€™éƒ½å¯ä»¥æŸ¥è¯¢å†å²äº‹ä»¶</li>
</ul>
</li>
<li>
<p>ç´¢å¼•ç‰¹æ€§ï¼š</p>
<ul>
<li>indexed å‚æ•°ä¼šåˆ›å»ºç´¢å¼•æ–¹ä¾¿å¿«é€ŸæŸ¥è¯¢</li>
<li>æœ€å¤šå¯ä»¥æœ‰ 3 ä¸ª indexed å‚æ•°</li>
<li>éç´¢å¼•å‚æ•°å¯ä»¥å­˜å‚¨ä»»æ„é•¿åº¦çš„æ•°æ®</li>
</ul>
</li>
</ol>
<h3 id="heading-28">äº‹ä»¶é‡æ”¾</h3>
<p>è™½ç„¶äº‹ä»¶æœ¬èº«æ²¡æœ‰é‡è¯•æœºåˆ¶ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡è¯»å–å†å²æ—¥å¿—æ¥&quot;é‡æ”¾&quot;é”™è¿‡çš„äº‹ä»¶ï¼š</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#75715e">// 1. è®°å½•ä¸Šæ¬¡å¤„ç†åˆ°çš„åŒºå—
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">lastProcessedBlock</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">getLastProcessedBlock</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 2. è·å–é”™è¿‡çš„äº‹ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">missedEvents</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">contract</span>.<span style="color:#a6e22e">getPastEvents</span>(<span style="color:#e6db74">&#39;Transfer&#39;</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fromBlock</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">lastProcessedBlock</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">toBlock</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;latest&#39;</span>
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 3. æŒ‰é¡ºåºå¤„ç†æ¯ä¸ªäº‹ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">event</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">missedEvents</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">processEvent</span>(<span style="color:#a6e22e">event</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// æ›´æ–°å¤„ç†è¿›åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">updateLastProcessedBlock</span>(<span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">blockNumber</span>);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;å¤„ç†äº‹ä»¶å¤±è´¥:&#39;</span>, <span style="color:#a6e22e">error</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// é”™è¯¯å¤„ç†...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><blockquote>
<p>äº‹ä»¶é‡æ”¾æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li>äº‹ä»¶å¤„ç†è¦åšåˆ°å¹‚ç­‰ï¼ˆé‡å¤å¤„ç†ä¸ä¼šäº§ç”Ÿå‰¯ä½œç”¨ï¼‰</li>
<li>è¦è®°å½•å¤„ç†è¿›åº¦ï¼Œé¿å…é‡å¤å¤„ç†</li>
<li>è€ƒè™‘åŒºå—é‡ç»„çš„æƒ…å†µï¼Œå¯èƒ½éœ€è¦å›æ»šä¸€äº›åŒºå—çš„å¤„ç†</li>
<li>å¤§é‡äº‹ä»¶é‡æ”¾è¦è€ƒè™‘æ€§èƒ½é—®é¢˜</li>
</ol>
</blockquote>
<h3 id="library">åº“ï¼ˆLibraryï¼‰</h3>
<p>åº“å°±åƒæ˜¯ä¸€ä¸ªå·¥å…·ç®±ï¼Œé‡Œé¢æ”¾ç€å„ç§å¯é‡ç”¨çš„å·¥å…·å‡½æ•°ã€‚å®ƒå¯ä»¥å¸®æˆ‘ä»¬èŠ‚çœ gasï¼Œä¹Ÿèƒ½è®©ä»£ç æ›´æ•´æ´ã€‚</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#75715e">// æ•°å­¦è®¡ç®—åº“
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">library</span> YieldMath {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// è®¡ç®—å¹´åŒ–æ”¶ç›Šç‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">calculateAPY</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> yield, 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> principal, 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> timeInSeconds
</span></span><span style="display:flex;"><span>    ) <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> (yield <span style="color:#f92672">*</span> <span style="color:#ae81ff">365</span> <span style="color:#66d9ef">days</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>) <span style="color:#f92672">/</span> (principal <span style="color:#f92672">*</span> timeInSeconds);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// è®¡ç®—å¤åˆ©
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">compoundInterest</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> principal,
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> ratePerYear,
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> timeInYears
</span></span><span style="display:flex;"><span>    ) <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ç®€åŒ–çš„å¤åˆ©è®¡ç®—
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">uint</span> rate <span style="color:#f92672">=</span> ratePerYear <span style="color:#f92672">+</span> <span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> result <span style="color:#f92672">=</span> principal;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">uint</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> timeInYears;) {
</span></span><span style="display:flex;"><span>            result <span style="color:#f92672">=</span> (result <span style="color:#f92672">*</span> rate) <span style="color:#f92672">/</span> <span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">unchecked</span> { <span style="color:#f92672">++</span>i; }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å®‰å…¨æ£€æŸ¥åº“
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">library</span> SafetyChecks {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æ£€æŸ¥åœ°å€æ˜¯å¦ä¸ºåˆçº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">isContract</span>(<span style="color:#66d9ef">address</span> account) <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">view</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> size;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">assembly</span> { size <span style="color:#f92672">:=</span> <span style="color:#a6e22e">extcodesize</span>(account) }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">return</span> size <span style="color:#960050;background-color:#1e0010">&gt;</span> <span style="color:#ae81ff">0</span><span style="color:#960050;background-color:#1e0010">;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// æ£€æŸ¥æ•°ç»„é•¿åº¦æ˜¯å¦åŒ¹é…
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">requireArrayLengths</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span>[] <span style="color:#66d9ef">memory</span> arr1, 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span>[] <span style="color:#66d9ef">memory</span> arr2
</span></span><span style="display:flex;"><span>    ) <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">pure</span> {
</span></span><span style="display:flex;"><span>        require(arr1.length <span style="color:#f92672">==</span> arr2.length, <span style="color:#e6db74">&#34;Array lengths mismatch&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ä½¿ç”¨åº“çš„åˆçº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">YieldAggregator</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">using</span> YieldMath <span style="color:#66d9ef">for</span> <span style="color:#66d9ef">uint</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">using</span> SafetyChecks <span style="color:#66d9ef">for</span> <span style="color:#66d9ef">address</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">calculateUserYield</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">address</span> user,
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> depositAmount,
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> duration
</span></span><span style="display:flex;"><span>    ) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">view</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        require(user.isContract() <span style="color:#f92672">==</span> <span style="color:#66d9ef">false</span>, <span style="color:#e6db74">&#34;User cannot be a contract&#34;</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> yield <span style="color:#f92672">=</span> getYield(user);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> apy <span style="color:#f92672">=</span> YieldMath.calculateAPY(yield, depositAmount, duration);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> YieldMath.compoundInterest(
</span></span><span style="display:flex;"><span>            depositAmount,
</span></span><span style="display:flex;"><span>            apy,
</span></span><span style="display:flex;"><span>            duration <span style="color:#f92672">/</span> <span style="color:#ae81ff">365</span> <span style="color:#66d9ef">days</span>
</span></span><span style="display:flex;"><span>        );
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><blockquote>
<p>åº“çš„æœ€ä½³å®è·µï¼š</p>
<ol>
<li>å°†é€šç”¨çš„çº¯å‡½æ•°æ”¾å…¥åº“ä¸­</li>
<li>ä½¿ç”¨ using for è¯­æ³•ç®€åŒ–è°ƒç”¨</li>
<li>åº“å‡½æ•°åº”è¯¥æ˜¯æ— çŠ¶æ€çš„</li>
<li>æ³¨æ„åº“çš„éƒ¨ç½²å’Œé“¾æ¥æˆæœ¬</li>
</ol>
</blockquote>
<h3 id="unchecked">å±è”½æº¢å‡ºæ£€æŸ¥ï¼ˆuncheckedï¼‰</h3>
<p>Solidity ä¸­çš„ unchecked ç”¨äºå…³é—­ä½œç”¨åŸŸå†…çš„æ•´æ•°æº¢å‡ºæ£€æŸ¥ã€‚å¯ä»¥èŠ‚çœ gas æ¶ˆè€—ã€‚</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#75715e">// SPDX-License-Identifier: MIT
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">pragma solidity</span> <span style="color:#f92672">^</span><span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">8</span>.<span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">Unchecked</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sum</span>() <span style="color:#66d9ef">external</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">uint</span> result <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">uint</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">1000</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">unchecked</span> {
</span></span><span style="display:flex;"><span>                result <span style="color:#f92672">+=</span> i;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><p>unchecked å¯¹äºå¤§æ‹¬å· {} ä¸­çš„ä»£ç è®¡ç®—ï¼Œä¸å†æ£€æŸ¥æ•´æ•°æ˜¯å¦æº¢å‡ºï¼Œä»è€Œæé«˜è®¡ç®—æ•ˆç‡ï¼ŒèŠ‚çœ gasã€‚</p>
<p>ä¸Šé¢çš„ä»£ç ï¼Œå¦‚æœä¸ä½¿ç”¨ uncheckedï¼Œgas æ¶ˆè€—ä¸º 381360ã€‚</p>
<p>å¦‚æœä½¿ç”¨äº† uncheckedï¼Œé‚£ä¹ˆ gas æ¶ˆè€—ä¸º 193360ï¼ŒèŠ‚çœäº†å·®ä¸å¤šä¸€åŠçš„ gas æ¶ˆè€—ã€‚</p>
<p>unchecked é€šå¸¸åœ¨å¤§é‡è®¡ç®—çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œæ•ˆæœæ‰ä¼šæ˜æ˜¾ã€‚å¦‚æœåªæ˜¯æ‰§è¡Œä¸€ä¸¤æ¬¡çš„è®¡ç®—ï¼Œå°±æ— éœ€ä½¿ç”¨äº†ã€‚</p>
<p>éœ€è¦æ³¨æ„æ˜¯ï¼Œunchecked ä¸å¯ä»¥æ»¥ç”¨ï¼Œå› ä¸ºå®ƒå±è”½æ‰äº†æ•´æ•°æº¢å‡ºæ£€æŸ¥ï¼Œä¼šå¸¦æ¥ä¸€å®šçš„å®‰å…¨é£é™©ã€‚æœªç»æ£€æŸ¥çš„æ•´æ•°è¿ç®—å¯èƒ½ä¼šå¯¼è‡´ä¸å¯é¢„æ–™çš„ç»“æœï¼Œç”šè‡³å¯èƒ½å¯¼è‡´åˆçº¦æ¼æ´æˆ–æ”»å‡»ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨ unchecked æ—¶ï¼Œéœ€è¦ç¡®ä¿ä½ å®Œå…¨ç†è§£ä»£ç çš„ä¸Šä¸‹æ–‡ï¼Œå¹¶èƒ½å¤Ÿç¡®ä¿åœ¨è¿™äº›æƒ…å†µä¸‹ä¸ä¼šå‘ç”Ÿæº¢å‡ºã€‚</p>
<h3 id="heading-29">å§”æ‰˜è°ƒç”¨</h3>
<p>delegatecall æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¶ˆæ¯è°ƒç”¨ï¼Œå®ƒå…è®¸ä¸€ä¸ªåˆçº¦æ‰§è¡Œå¦ä¸€ä¸ªåˆçº¦çš„ä»£ç ï¼Œä½†æ˜¯åœ¨å½“å‰åˆçº¦çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚è¿™å°±åƒæ˜¯&quot;å€Ÿç”¨&quot;åˆ«äººçš„ä»£ç ï¼Œä½†åœ¨è‡ªå·±çš„&quot;åœ°ç›˜&quot;ä¸Šè¿è¡Œã€‚</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#75715e">// é€»è¾‘åˆçº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">LogicContract</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> value;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">address</span> <span style="color:#66d9ef">public</span> sender;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> amount;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">setValue</span>(<span style="color:#66d9ef">uint</span> _value) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">payable</span> {
</span></span><span style="display:flex;"><span>        value <span style="color:#f92672">=</span> _value;
</span></span><span style="display:flex;"><span>        sender <span style="color:#f92672">=</span> msg.sender;
</span></span><span style="display:flex;"><span>        amount <span style="color:#f92672">=</span> msg.value;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ä»£ç†åˆçº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">ProxyContract</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> value;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">address</span> <span style="color:#66d9ef">public</span> sender;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint</span> <span style="color:#66d9ef">public</span> amount;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">executeLogic</span>(<span style="color:#66d9ef">address</span> _logic, <span style="color:#66d9ef">bytes</span> <span style="color:#66d9ef">memory</span> _data) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">payable</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ä½¿ç”¨ delegatecall è°ƒç”¨é€»è¾‘åˆçº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        (<span style="color:#66d9ef">bool</span> success, ) <span style="color:#f92672">=</span> _logic.delegatecall(_data);
</span></span><span style="display:flex;"><span>        require(success, <span style="color:#e6db74">&#34;Delegatecall failed&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><blockquote>
<p>ä½¿ç”¨ delegatecall éœ€è¦æ³¨æ„ï¼š</p>
<ol>
<li>çŠ¶æ€å˜é‡çš„å¸ƒå±€å¿…é¡»å®Œå…¨ç›¸åŒ</li>
<li>å¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ï¼Œéœ€è¦ä»”ç»†æ§åˆ¶æƒé™</li>
<li>å¸¸ç”¨äºä»£ç†æ¨¡å¼å’Œåˆçº¦å‡çº§</li>
</ol>
</blockquote>
<h3 id="heading-30">å†…è”æ±‡ç¼–</h3>
<p>Solidity å…è®¸æˆ‘ä»¬ä½¿ç”¨å†…è”æ±‡ç¼–æ¥ç›´æ¥æ“ä½œ EVMã€‚è¿™å°±åƒæ˜¯ç»™äº†æˆ‘ä»¬ä¸€æŠŠ&quot;ä¸‡èƒ½é’¥åŒ™&quot;ï¼Œå¯ä»¥åšä¸€äº›æ™®é€š Solidity åšä¸åˆ°çš„äº‹æƒ…ï¼š</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">AssemblyExample</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ä½¿ç”¨æ±‡ç¼–ä¼˜åŒ–å­˜å‚¨æ“ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">writeStorage</span>(<span style="color:#66d9ef">uint</span> slot, <span style="color:#66d9ef">uint</span> value) <span style="color:#66d9ef">public</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">assembly</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">sstore</span>(slot, value)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ä½¿ç”¨æ±‡ç¼–è¯»å–åˆçº¦ä»£ç å¤§å°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getCodeSize</span>(<span style="color:#66d9ef">address</span> addr) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">view</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span> size) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">assembly</span> {
</span></span><span style="display:flex;"><span>            size <span style="color:#f92672">:=</span> <span style="color:#a6e22e">extcodesize</span>(addr)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ä½¿ç”¨æ±‡ç¼–è¿›è¡Œé«˜æ•ˆçš„å†…å­˜æ“ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">efficientArraySum</span>(<span style="color:#66d9ef">uint</span>[] <span style="color:#66d9ef">memory</span> arr) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">uint</span> sum) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">assembly</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">let</span> len <span style="color:#f92672">:=</span> <span style="color:#a6e22e">mload</span>(arr)
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">let</span> data <span style="color:#f92672">:=</span> <span style="color:#a6e22e">add</span>(arr, <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">for</span> { <span style="color:#f92672">let</span> i <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span> } <span style="color:#a6e22e">lt</span>(i, len) { i <span style="color:#f92672">:=</span> <span style="color:#a6e22e">add</span>(i, <span style="color:#ae81ff">1</span>) }
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                sum <span style="color:#f92672">:=</span> <span style="color:#a6e22e">add</span>(sum, <span style="color:#a6e22e">mload</span>(<span style="color:#a6e22e">add</span>(data, <span style="color:#a6e22e">mul</span>(i, <span style="color:#ae81ff">0x20</span>))))
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><h3 id="heading-31">åˆ›å»ºåˆçº¦</h3>
<p>Solidity æä¾›äº†ä¸¤ç§åœ¨è¿è¡Œæ—¶åˆ›å»ºæ–°åˆçº¦çš„æ–¹æ³•ï¼šcreate å’Œ create2ã€‚</p>
<pre style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">contract</span> <span style="color:#a6e22e">Factory</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ä½¿ç”¨ create éƒ¨ç½²åˆçº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">deployWithCreate</span>(<span style="color:#66d9ef">uint</span> _salt) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">address</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">bytes</span> <span style="color:#66d9ef">memory</span> bytecode <span style="color:#f92672">=</span> type(<span style="color:#a6e22e">MyContract</span>).creationCode;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">address</span> addr;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">assembly</span> {
</span></span><span style="display:flex;"><span>            addr <span style="color:#f92672">:=</span> <span style="color:#a6e22e">create</span>(<span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">add</span>(bytecode, <span style="color:#ae81ff">0x20</span>), <span style="color:#a6e22e">mload</span>(bytecode))
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">return</span> addr<span style="color:#960050;background-color:#1e0010">;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ä½¿ç”¨ create2 éƒ¨ç½²åˆçº¦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">deployWithCreate2</span>(<span style="color:#66d9ef">uint</span> _salt) <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">returns</span> (<span style="color:#66d9ef">address</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">bytes</span> <span style="color:#66d9ef">memory</span> bytecode <span style="color:#f92672">=</span> type(<span style="color:#a6e22e">MyContract</span>).creationCode;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">address</span> addr;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">assembly</span> {
</span></span><span style="display:flex;"><span>            addr <span style="color:#f92672">:=</span> create2(<span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">add</span>(bytecode, <span style="color:#ae81ff">0x20</span>), <span style="color:#a6e22e">mload</span>(bytecode), _salt)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">return</span> addr<span style="color:#960050;background-color:#1e0010">;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre><hr />
<h2 id="heading-32">ç»“è¯­</h2>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»å®Œæ•´åœ°æ¢ç´¢äº† Solidity çš„ä¸»è¦ç‰¹æ€§ã€‚ä»åŸºç¡€çš„æ•°æ®ç±»å‹åˆ°é«˜çº§çš„å§”æ‰˜è°ƒç”¨ï¼Œä»ç®€å•çš„å‡½æ•°å®šä¹‰åˆ°å¤æ‚çš„åˆçº¦äº¤äº’ï¼Œç›¸ä¿¡ä½ å·²ç»å¯¹ Solidity ç¼–ç¨‹æœ‰äº†å…¨é¢çš„è®¤è¯†ã€‚</p>
<p>è®°ä½ï¼ŒåŒºå—é“¾ä¸–ç•Œæ—¥æ–°æœˆå¼‚ï¼ŒSolidity ä¹Ÿåœ¨ä¸æ–­å‘å±•ã€‚è¿™ç¯‡æŒ‡å—ä¸ºä½ æ‰“å¼€äº†æ™ºèƒ½åˆçº¦å¼€å‘çš„å¤§é—¨ï¼Œä½†çœŸæ­£çš„å­¦ä¹ ä¹‹æ—…æ‰åˆšåˆšå¼€å§‹ã€‚</p>

                    </div>

                    
                    <div class="flex items-center justify-between gap-4 p-4 lg:p-6 border-t border-stars-accent/10
                                bg-gradient-to-br from-transparent to-stars-accent/5">
                        
                        <button onclick="share()" 
                                class="inline-flex items-center gap-2 px-4 py-2 rounded-xl
                                       bg-stars-primary/30 backdrop-blur-sm
                                       border border-stars-accent/20 
                                       text-stars-accent hover:bg-stars-accent/10
                                       hover:scale-[1.02] active:scale-[0.98]
                                       transition-all duration-300">
                            <i class="fas fa-share-alt"></i>
                            <span>åˆ†äº«æ–‡ç« </span>
                        </button>

                        
                        
                        <button onclick="copyHash('0x47c54e59d3e44e9b2ede352ca79e99a7e05a5f7ff9d1208e84a2162583bee4bb1.0.0')"
                                class="inline-flex items-center gap-2 px-4 py-2 rounded-xl
                                       bg-stars-primary/30 backdrop-blur-sm
                                       border border-stars-accent/20 
                                       text-stars-accent hover:bg-stars-accent/10
                                       hover:scale-[1.02] active:scale-[0.98]
                                       transition-all duration-300
                                       group">
                            <i class="fas fa-fingerprint text-stars-accent/70 group-hover:text-stars-accent"></i>
                            <code class="font-mono text-sm truncate max-w-[150px]">0x47c54e59d3e44e9b2ede352ca79e99a7e05a5f7ff9d1208e84a2162583bee4bb1.0.0</code>
                        </button>
                        
                    </div>
                </div>

                
                

<div class="newsletter-container bg-stars-secondary/80 backdrop-blur-sm rounded-2xl 
            border border-stars-accent/10 p-6 my-8">
    <h3 class="text-xl font-bold text-stars-accent mb-3">è®¢é˜…æ›´æ–°</h3>
    <p class="text-stars-muted mb-4">è®¢é˜…è·å–æœ€æ–°æ–‡ç« æ›´æ–°</p>
    
    
    <form
        action="https://buttondown.email/api/emails/embed-subscribe/lige"
        method="post"
        target="popupwindow"
        class="flex gap-2"
        onsubmit="window.open('https://buttondown.email/lige', 'popupwindow')"
    >
        <input
            type="email"
            name="email"
            placeholder="your@email.com"
            class="flex-1 px-4 py-2 rounded-xl bg-stars-primary/30 
                   border border-stars-accent/20 text-stars-accent
                   focus:border-stars-accent focus:outline-none"
            required
        >
        <button 
            type="submit"
            class="px-6 py-2 rounded-xl bg-stars-accent/10 text-stars-accent
                   hover:bg-stars-accent/20 transition-all duration-300"
        >
            è®¢é˜…
        </button>
    </form>
</div>


                
                
                

                
                
                <div class="mb-8">
                    <div class="bg-stars-secondary/80 backdrop-blur-sm rounded-2xl border border-stars-accent/10 p-4 sm:p-6" id="series-nav">
                        
                        <div class="sm:hidden">
                            <h3 class="text-lg font-bold mb-3">æ¢ç´¢Web3ä¸–ç•Œ</h3>
                            <div class="text-stars-muted text-sm mb-4">
                                æ‚¨æ­£åœ¨é˜…è¯» <span class="text-stars-accent">æ¢ç´¢Web3ä¸–ç•Œ</span> ç³»åˆ—çš„ç¬¬ 5 ç¯‡æ–‡ç« 
                            </div>
                            <a href="/series/%e6%8e%a2%e7%b4%a2Web3%e4%b8%96%e7%95%8c" 
                               class="block w-full text-center px-4 py-2.5 rounded-xl bg-stars-primary/20 border border-stars-accent/20 
                                      hover:border-stars-accent/30 hover:bg-stars-accent/5 
                                      transition-all duration-300">
                                <span class="flex items-center justify-center gap-2">
                                    <span class="text-sm">æŸ¥çœ‹ç³»åˆ—å…¨éƒ¨æ–‡ç« </span>
                                    <i class="fas fa-arrow-right text-stars-accent/80"></i>
                                </span>
                            </a>
                        </div>

                        
                        <div class="hidden sm:block">
                            <div class="flex items-center justify-between gap-4 mb-4">
                                <div class="flex items-center gap-3">
                                    <h3 class="text-lg font-bold">æ¢ç´¢Web3ä¸–ç•Œ</h3>
                                </div>
                                <a href="/series/%e6%8e%a2%e7%b4%a2Web3%e4%b8%96%e7%95%8c" 
                                   class="px-4 py-2 rounded-xl bg-stars-primary/20 border border-stars-accent/20 
                                          hover:border-stars-accent/30 hover:bg-stars-accent/5 
                                          transition-all duration-300">
                                    <span class="flex items-center gap-2">
                                        <span class="text-sm">æŸ¥çœ‹ç³»åˆ—å…¨éƒ¨æ–‡ç« </span>
                                        <i class="fas fa-arrow-right text-stars-accent/80"></i>
                                    </span>
                                </a>
                            </div>
                            <div class="text-stars-muted">
                                æ‚¨æ­£åœ¨é˜…è¯» <span class="text-stars-accent">æ¢ç´¢Web3ä¸–ç•Œ</span> ç³»åˆ—çš„ç¬¬ 5 ç¯‡æ–‡ç« 
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>

        
        
        <div class="hidden lg:block lg:col-span-3">
            <div class="sticky top-24">
                
<div class="table-of-contents-wrapper">
    <div class="text-lg font-bold text-stars-accent mb-4">ç›®å½•</div>
    <nav class="table-of-contents">
        <ul>
            
            <li>
                <a href="#heading" 
                   title="åŸºç¡€çŸ¥è¯†"
                   class="toc-link toc-link-root"
                   data-level="2">
                    åŸºç¡€çŸ¥è¯†
                </a>
                
                    <ul>
                        
    
    <li>
        <a href="#-solidity" 
           title="ä¸ºä»€ä¹ˆé€‰æ‹© Solidityï¼Ÿ"
           class="toc-link toc-link-child"
           data-level="3">
            ä¸ºä»€ä¹ˆé€‰æ‹© Solidityï¼Ÿ
        </a>
        
    </li>
    
    <li>
        <a href="#remix-ide" 
           title="å¼€å‘ç¯å¢ƒï¼šRemix IDE"
           class="toc-link toc-link-child"
           data-level="3">
            å¼€å‘ç¯å¢ƒï¼šRemix IDE
        </a>
        
    </li>
    
    <li>
        <a href="#heading-1" 
           title="æ•°æ®å­˜å‚¨ä½ç½®"
           class="toc-link toc-link-child"
           data-level="3">
            æ•°æ®å­˜å‚¨ä½ç½®
        </a>
        
            <ul>
                
    
    <li>
        <a href="#storage" 
           title="Storageï¼ˆæ°¸ä¹…å­˜å‚¨ï¼‰"
           class="toc-link toc-link-child"
           data-level="4">
            Storageï¼ˆæ°¸ä¹…å­˜å‚¨ï¼‰
        </a>
        
    </li>
    
    <li>
        <a href="#memory" 
           title="Memoryï¼ˆä¸´æ—¶å­˜å‚¨ï¼‰"
           class="toc-link toc-link-child"
           data-level="4">
            Memoryï¼ˆä¸´æ—¶å­˜å‚¨ï¼‰
        </a>
        
    </li>
    

            </ul>
        
    </li>
    
    <li>
        <a href="#import-" 
           title="import å¯¼å…¥"
           class="toc-link toc-link-child"
           data-level="3">
            import å¯¼å…¥
        </a>
        
    </li>
    
    <li>
        <a href="#heading-2" 
           title="ç‰ˆæƒå£°æ˜"
           class="toc-link toc-link-child"
           data-level="3">
            ç‰ˆæƒå£°æ˜
        </a>
        
    </li>
    
    <li>
        <a href="#heading-3" 
           title="ç‰ˆæœ¬å£°æ˜"
           class="toc-link toc-link-child"
           data-level="3">
            ç‰ˆæœ¬å£°æ˜
        </a>
        
    </li>
    
    <li>
        <a href="#heading-4" 
           title="å®šä¹‰åˆçº¦"
           class="toc-link toc-link-child"
           data-level="3">
            å®šä¹‰åˆçº¦
        </a>
        
    </li>
    

                    </ul>
                
            </li>
            
            <li>
                <a href="#heading-5" 
                   title="æ•°æ®ç±»å‹å’Œå˜é‡"
                   class="toc-link toc-link-root"
                   data-level="2">
                    æ•°æ®ç±»å‹å’Œå˜é‡
                </a>
                
                    <ul>
                        
    
    <li>
        <a href="#heading-6" 
           title="åŸºæœ¬æ•°æ®ç±»å‹"
           class="toc-link toc-link-child"
           data-level="3">
            åŸºæœ¬æ•°æ®ç±»å‹
        </a>
        
            <ul>
                
    
    <li>
        <a href="#bool" 
           title="å¸ƒå°”å‹ï¼ˆboolï¼‰"
           class="toc-link toc-link-child"
           data-level="4">
            å¸ƒå°”å‹ï¼ˆboolï¼‰
        </a>
        
    </li>
    
    <li>
        <a href="#integer" 
           title="æ•´æ•°ç±»å‹ï¼ˆIntegerï¼‰"
           class="toc-link toc-link-child"
           data-level="4">
            æ•´æ•°ç±»å‹ï¼ˆIntegerï¼‰
        </a>
        
    </li>
    
    <li>
        <a href="#-uint256--gas" 
           title="ä¸ºä»€ä¹ˆ uint256 æœ‰æ—¶å€™æ›´çœ gasï¼Ÿ"
           class="toc-link toc-link-child"
           data-level="4">
            ä¸ºä»€ä¹ˆ uint256 æœ‰æ—¶å€™æ›´çœ gasï¼Ÿ
        </a>
        
    </li>
    
    <li>
        <a href="#address" 
           title="åœ°å€ç±»å‹ï¼ˆAddressï¼‰"
           class="toc-link toc-link-child"
           data-level="4">
            åœ°å€ç±»å‹ï¼ˆAddressï¼‰
        </a>
        
    </li>
    
    <li>
        <a href="#bytes" 
           title="å­—èŠ‚ç±»å‹ï¼ˆBytesï¼‰"
           class="toc-link toc-link-child"
           data-level="4">
            å­—èŠ‚ç±»å‹ï¼ˆBytesï¼‰
        </a>
        
    </li>
    

            </ul>
        
    </li>
    
    <li>
        <a href="#heading-7" 
           title="å¤æ‚æ•°æ®ç±»å‹"
           class="toc-link toc-link-child"
           data-level="3">
            å¤æ‚æ•°æ®ç±»å‹
        </a>
        
            <ul>
                
    
    <li>
        <a href="#heading-8" 
           title="æ•°ç»„"
           class="toc-link toc-link-child"
           data-level="4">
            æ•°ç»„
        </a>
        
    </li>
    
    <li>
        <a href="#heading-9" 
           title="å­—ç¬¦ä¸²"
           class="toc-link toc-link-child"
           data-level="4">
            å­—ç¬¦ä¸²
        </a>
        
    </li>
    
    <li>
        <a href="#heading-10" 
           title="æ˜ å°„"
           class="toc-link toc-link-child"
           data-level="4">
            æ˜ å°„
        </a>
        
    </li>
    

            </ul>
        
    </li>
    
    <li>
        <a href="#heading-11" 
           title="å¸¸é‡"
           class="toc-link toc-link-child"
           data-level="3">
            å¸¸é‡
        </a>
        
            <ul>
                
    
    <li>
        <a href="#constant" 
           title="constant"
           class="toc-link toc-link-child"
           data-level="4">
            constant
        </a>
        
    </li>
    
    <li>
        <a href="#immutable" 
           title="immutable"
           class="toc-link toc-link-child"
           data-level="4">
            immutable
        </a>
        
    </li>
    
    <li>
        <a href="#constant-vs-immutable-" 
           title="constant vs immutable å¦‚ä½•é€‰æ‹©ï¼Ÿ"
           class="toc-link toc-link-child"
           data-level="4">
            constant vs immutable å¦‚ä½•é€‰æ‹©ï¼Ÿ
        </a>
        
    </li>
    

            </ul>
        
    </li>
    

                    </ul>
                
            </li>
            
            <li>
                <a href="#heading-12" 
                   title="å‡½æ•°"
                   class="toc-link toc-link-root"
                   data-level="2">
                    å‡½æ•°
                </a>
                
                    <ul>
                        
    
    <li>
        <a href="#heading-13" 
           title="å‡½æ•°å®šä¹‰"
           class="toc-link toc-link-child"
           data-level="3">
            å‡½æ•°å®šä¹‰
        </a>
        
    </li>
    
    <li>
        <a href="#heading-14" 
           title="å‡½æ•°å¯è§æ€§"
           class="toc-link toc-link-child"
           data-level="3">
            å‡½æ•°å¯è§æ€§
        </a>
        
    </li>
    
    <li>
        <a href="#heading-15" 
           title="å‡½æ•°ä¿®é¥°ç¬¦"
           class="toc-link toc-link-child"
           data-level="3">
            å‡½æ•°ä¿®é¥°ç¬¦
        </a>
        
    </li>
    
    <li>
        <a href="#heading-16" 
           title="ç‰¹æ®Šå‡½æ•°"
           class="toc-link toc-link-child"
           data-level="3">
            ç‰¹æ®Šå‡½æ•°
        </a>
        
    </li>
    
    <li>
        <a href="#heading-17" 
           title="å‡½æ•°é‡è½½"
           class="toc-link toc-link-child"
           data-level="3">
            å‡½æ•°é‡è½½
        </a>
        
    </li>
    

                    </ul>
                
            </li>
            
            <li>
                <a href="#heading-18" 
                   title="ç¨‹åºæ§åˆ¶"
                   class="toc-link toc-link-root"
                   data-level="2">
                    ç¨‹åºæ§åˆ¶
                </a>
                
                    <ul>
                        
    
    <li>
        <a href="#heading-19" 
           title="é”™è¯¯å¤„ç†æœ€ä½³å®è·µ"
           class="toc-link toc-link-child"
           data-level="3">
            é”™è¯¯å¤„ç†æœ€ä½³å®è·µ
        </a>
        
    </li>
    

                    </ul>
                
            </li>
            
            <li>
                <a href="#heading-20" 
                   title="é¢å‘å¯¹è±¡ç‰¹æ€§"
                   class="toc-link toc-link-root"
                   data-level="2">
                    é¢å‘å¯¹è±¡ç‰¹æ€§
                </a>
                
                    <ul>
                        
    
    <li>
        <a href="#heading-21" 
           title="ç»§æ‰¿"
           class="toc-link toc-link-child"
           data-level="3">
            ç»§æ‰¿
        </a>
        
    </li>
    
    <li>
        <a href="#heading-22" 
           title="æ¥å£"
           class="toc-link toc-link-child"
           data-level="3">
            æ¥å£
        </a>
        
    </li>
    
    <li>
        <a href="#heading-23" 
           title="æŠ½è±¡åˆçº¦"
           class="toc-link toc-link-child"
           data-level="3">
            æŠ½è±¡åˆçº¦
        </a>
        
    </li>
    

                    </ul>
                
            </li>
            
            <li>
                <a href="#heading-24" 
                   title="é«˜çº§ç‰¹æ€§"
                   class="toc-link toc-link-root"
                   data-level="2">
                    é«˜çº§ç‰¹æ€§
                </a>
                
                    <ul>
                        
    
    <li>
        <a href="#modifier" 
           title="ä¿®é¥°ç¬¦ï¼ˆmodifierï¼‰"
           class="toc-link toc-link-child"
           data-level="3">
            ä¿®é¥°ç¬¦ï¼ˆmodifierï¼‰
        </a>
        
    </li>
    
    <li>
        <a href="#event" 
           title="äº‹ä»¶ï¼ˆeventï¼‰"
           class="toc-link toc-link-child"
           data-level="3">
            äº‹ä»¶ï¼ˆeventï¼‰
        </a>
        
            <ul>
                
    
    <li>
        <a href="#heading-25" 
           title="äº‹ä»¶çš„å­˜å‚¨ä½ç½®"
           class="toc-link toc-link-child"
           data-level="4">
            äº‹ä»¶çš„å­˜å‚¨ä½ç½®
        </a>
        
    </li>
    
    <li>
        <a href="#heading-26" 
           title="äº‹ä»¶çš„æ¥æ”¶æ–¹å¼"
           class="toc-link toc-link-child"
           data-level="4">
            äº‹ä»¶çš„æ¥æ”¶æ–¹å¼
        </a>
        
    </li>
    
    <li>
        <a href="#heading-27" 
           title="äº‹ä»¶çš„ç‰¹ç‚¹"
           class="toc-link toc-link-child"
           data-level="4">
            äº‹ä»¶çš„ç‰¹ç‚¹
        </a>
        
    </li>
    

            </ul>
        
    </li>
    
    <li>
        <a href="#heading-28" 
           title="äº‹ä»¶é‡æ”¾"
           class="toc-link toc-link-child"
           data-level="3">
            äº‹ä»¶é‡æ”¾
        </a>
        
    </li>
    
    <li>
        <a href="#library" 
           title="åº“ï¼ˆLibraryï¼‰"
           class="toc-link toc-link-child"
           data-level="3">
            åº“ï¼ˆLibraryï¼‰
        </a>
        
    </li>
    
    <li>
        <a href="#unchecked" 
           title="å±è”½æº¢å‡ºæ£€æŸ¥ï¼ˆuncheckedï¼‰"
           class="toc-link toc-link-child"
           data-level="3">
            å±è”½æº¢å‡ºæ£€æŸ¥ï¼ˆuncheckedï¼‰
        </a>
        
    </li>
    
    <li>
        <a href="#heading-29" 
           title="å§”æ‰˜è°ƒç”¨"
           class="toc-link toc-link-child"
           data-level="3">
            å§”æ‰˜è°ƒç”¨
        </a>
        
    </li>
    
    <li>
        <a href="#heading-30" 
           title="å†…è”æ±‡ç¼–"
           class="toc-link toc-link-child"
           data-level="3">
            å†…è”æ±‡ç¼–
        </a>
        
    </li>
    
    <li>
        <a href="#heading-31" 
           title="åˆ›å»ºåˆçº¦"
           class="toc-link toc-link-child"
           data-level="3">
            åˆ›å»ºåˆçº¦
        </a>
        
    </li>
    

                    </ul>
                
            </li>
            
            <li>
                <a href="#heading-32" 
                   title="ç»“è¯­"
                   class="toc-link toc-link-root"
                   data-level="2">
                    ç»“è¯­
                </a>
                
            </li>
            
        </ul>
    </nav>
</div>

            </div>
        </div>
        
    </div>

    
    <button id="backToTop" 
            onclick="scrollToTop()"
            class="fixed bottom-8 right-8 p-3 rounded-xl
                   bg-stars-secondary/80 backdrop-blur-sm
                   border border-stars-accent/20 text-stars-accent
                   hover:bg-stars-accent/10 hover:scale-110
                   active:scale-95
                   transition-all duration-300
                   opacity-0 invisible
                   lg:bottom-12 lg:right-12
                   shadow-lg shadow-stars-accent/5">
        <i class="fas fa-arrow-up"></i>
    </button>

    
    <div id="shareModal" class="fixed inset-0 z-50 bg-black/50 backdrop-blur-sm opacity-0 pointer-events-none transition-opacity duration-300">
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 
                    w-full max-w-md p-6 
                    bg-stars-secondary/90 backdrop-blur-sm 
                    rounded-xl border border-stars-accent/20">
            <div class="flex justify-between items-center mb-8">
                <h3 class="text-2xl font-bold text-stars-accent">åˆ†äº«æ–‡ç« </h3>
                <button onclick="closeModal('shareModal')" 
                        class="w-8 h-8 flex items-center justify-center rounded-xl
                               hover:bg-stars-primary/30 text-stars-muted hover:text-stars-accent 
                               transition-all">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="grid grid-cols-3 gap-4 mb-6">
                <button onclick="shareToTwitter()" 
                        class="flex flex-col items-center gap-2 p-4 rounded-xl
                               bg-stars-primary/30 hover:bg-stars-accent/20 
                               text-stars-accent transition-all duration-300
                               group">
                    <i class="fab fa-twitter text-2xl group-hover:scale-110 transition-transform"></i>
                    <span class="text-sm">Twitter</span>
                </button>
                <button onclick="shareToTelegram()" 
                        class="flex flex-col items-center gap-2 p-4 rounded-xl
                               bg-stars-primary/30 hover:bg-stars-accent/20 
                               text-stars-accent transition-all duration-300
                               group">
                    <i class="fab fa-telegram text-2xl group-hover:scale-110 transition-transform"></i>
                    <span class="text-sm">Telegram</span>
                </button>
                <button onclick="shareToReddit()" 
                        class="flex flex-col items-center gap-2 p-4 rounded-xl
                               bg-stars-primary/30 hover:bg-stars-accent/20 
                               text-stars-accent transition-all duration-300
                               group">
                    <i class="fab fa-reddit text-2xl group-hover:scale-110 transition-transform"></i>
                    <span class="text-sm">Reddit</span>
                </button>
            </div>
            <button onclick="copyLink()" 
                    class="w-full flex items-center justify-center gap-2 px-6 py-3 rounded-xl
                           bg-stars-primary/30 hover:bg-stars-accent/20 
                           text-stars-accent transition-all duration-300
                           group">
                <i class="fas fa-link text-lg group-hover:scale-110 transition-transform"></i>
                <span>å¤åˆ¶é“¾æ¥</span>
            </button>
        </div>
    </div>

    
    <div id="toast" 
         class="fixed bottom-8 left-1/2 -translate-x-1/2 
                py-3 px-6 rounded-xl
                backdrop-blur-sm
                border border-stars-accent/20
                shadow-lg
                transform transition-all duration-300 scale-0 opacity-0
                flex items-center gap-3
                bg-stars-accent/10 text-stars-accent">
        <span id="toastIcon">
            <i class="fas fa-check-circle text-lg"></i>
        </span>
        <span id="toastMessage"></span>
    </div>

    
    <script>
    function share() {
        const modal = document.getElementById('shareModal');
        modal.classList.remove('opacity-0', 'pointer-events-none');
    }

    function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        modal.classList.add('opacity-0', 'pointer-events-none');
    }

    function shareToTwitter() {
        const text = encodeURIComponent(`${document.title}`);
        const url = encodeURIComponent(window.location.href);
        window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}`, '_blank');
    }

    function shareToTelegram() {
        const text = encodeURIComponent(document.title);
        const url = encodeURIComponent(window.location.href);
        window.open(`https://t.me/share/url?url=${url}&text=${text}`, '_blank');
    }

    function shareToReddit() {
        const url = encodeURIComponent(window.location.href);
        const title = encodeURIComponent(document.title);
        window.open(`https://reddit.com/submit?url=${url}&title=${title}`, '_blank');
    }

    function copyLink() {
        const tempInput = document.createElement('input');
        tempInput.value = window.location.href;
        document.body.appendChild(tempInput);
        tempInput.select();
        
        try {
            document.execCommand('copy');
            window.showToast('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ âœ¨');
            closeModal('shareModal');
        } catch (err) {
            window.showToast('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶é“¾æ¥');
        } finally {
            document.body.removeChild(tempInput);
        }
    }

    
    document.getElementById('shareModal').addEventListener('click', function(e) {
        if (e.target === this) {
            e.target.classList.add('opacity-0', 'pointer-events-none');
        }
    });
    </script>

    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const tocLinks = document.querySelectorAll('.toc-link');
        const headings = document.querySelectorAll('.content h1, .content h2, .content h3, .content h4, .content h5, .content h6');
        let isScrolling = false;  
        
        
        tocLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                isScrolling = true;  
                
                const href = link.getAttribute('href');
                const targetId = href.substring(1);
                const target = document.getElementById(targetId);
                
                if (target) {
                    
                    tocLinks.forEach(l => l.classList.remove('active'));
                    
                    link.classList.add('active');
                    
                    const offset = target.offsetTop - 100;
                    window.scrollTo({
                        top: offset,
                        behavior: 'smooth'
                    });
                    
                    
                    history.pushState(null, '', href);
                    
                    
                    setTimeout(() => {
                        isScrolling = false;
                    }, 100);
                }
            });
        });

        
        const observerOptions = {
            root: null,
            rootMargin: '-100px 0px -80% 0px',
            threshold: [0, 1]  
        };

        const headingObserver = new IntersectionObserver((entries) => {
            if (isScrolling) return;  

            
            const visibleEntries = entries.filter(entry => entry.isIntersecting);
            if (visibleEntries.length === 0) return;

            
            const topEntry = visibleEntries.reduce((prev, curr) => {
                const prevY = Math.abs(prev.boundingClientRect.y);
                const currY = Math.abs(curr.boundingClientRect.y);
                return prevY < currY ? prev : curr;
            });

            const id = topEntry.target.id;
            
            
            tocLinks.forEach(link => {
                const href = link.getAttribute('href');
                if (href === `#${id}`) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });
        }, observerOptions);

        
        headings.forEach(heading => {
            if (heading.id) {
                headingObserver.observe(heading);
            }
        });

        
        if (window.location.hash) {
            const targetId = window.location.hash.slice(1);
            const target = document.getElementById(targetId);
            if (target) {
                setTimeout(() => {
                    const offset = target.offsetTop - 100;
                    window.scrollTo({
                        top: offset,
                        behavior: 'smooth'
                    });
                    
                    console.log(targetId);
                    
                    const activeLink = document.querySelector(`.toc-link[href="#${targetId}"]`);
                    if (activeLink) {
                        tocLinks.forEach(l => l.classList.remove('active'));
                        activeLink.classList.add('active');
                    }
                }, 100);
            }
        }
    });
    </script>

    
    <script>
    
    const backToTopButton = document.getElementById('backToTop');
    
    window.addEventListener('scroll', () => {
        if (window.scrollY > 500) {
            backToTopButton.classList.remove('opacity-0', 'invisible');
            backToTopButton.classList.add('opacity-100', 'visible');
        } else {
            backToTopButton.classList.add('opacity-0', 'invisible');
            backToTopButton.classList.remove('opacity-100', 'visible');
        }
    });

    
    function scrollToTop() {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    }

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    if ('vibrate' in navigator) {
        const buttons = document.querySelectorAll('button, a');
        buttons.forEach(button => {
            button.addEventListener('click', () => {
                navigator.vibrate(10);
            });
        });
    }
    </script>

    
    <div class="lg:hidden fixed bottom-8 left-8 z-50" id="tocButton">
        <button onclick="toggleToc()"
                class="p-3 rounded-xl bg-stars-secondary/80 backdrop-blur-sm
                       border border-stars-accent/20 text-stars-accent
                       hover:bg-stars-accent/10 transition-all duration-300
                       shadow-lg shadow-stars-accent/5">
            <i class="fas fa-list-ul"></i>
        </button>
    </div>

    
    <div id="tocDrawer" 
         class="lg:hidden fixed inset-0 z-40 transform transition-transform duration-300 translate-x-full">
        <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="toggleToc()"></div>
        <div class="absolute right-0 top-0 bottom-0 w-3/4 max-w-sm bg-stars-secondary/95 backdrop-blur-sm
                    border-l border-stars-accent/20 overflow-y-auto
                    pt-20">
            <div>
                
<div class="table-of-contents-wrapper">
    <div class="text-lg font-bold text-stars-accent mb-4">ç›®å½•</div>
    <nav class="table-of-contents">
        <ul>
            
            <li>
                <a href="#heading" 
                   title="åŸºç¡€çŸ¥è¯†"
                   class="toc-link toc-link-root"
                   data-level="2">
                    åŸºç¡€çŸ¥è¯†
                </a>
                
                    <ul>
                        
    
    <li>
        <a href="#-solidity" 
           title="ä¸ºä»€ä¹ˆé€‰æ‹© Solidityï¼Ÿ"
           class="toc-link toc-link-child"
           data-level="3">
            ä¸ºä»€ä¹ˆé€‰æ‹© Solidityï¼Ÿ
        </a>
        
    </li>
    
    <li>
        <a href="#remix-ide" 
           title="å¼€å‘ç¯å¢ƒï¼šRemix IDE"
           class="toc-link toc-link-child"
           data-level="3">
            å¼€å‘ç¯å¢ƒï¼šRemix IDE
        </a>
        
    </li>
    
    <li>
        <a href="#heading-1" 
           title="æ•°æ®å­˜å‚¨ä½ç½®"
           class="toc-link toc-link-child"
           data-level="3">
            æ•°æ®å­˜å‚¨ä½ç½®
        </a>
        
            <ul>
                
    
    <li>
        <a href="#storage" 
           title="Storageï¼ˆæ°¸ä¹…å­˜å‚¨ï¼‰"
           class="toc-link toc-link-child"
           data-level="4">
            Storageï¼ˆæ°¸ä¹…å­˜å‚¨ï¼‰
        </a>
        
    </li>
    
    <li>
        <a href="#memory" 
           title="Memoryï¼ˆä¸´æ—¶å­˜å‚¨ï¼‰"
           class="toc-link toc-link-child"
           data-level="4">
            Memoryï¼ˆä¸´æ—¶å­˜å‚¨ï¼‰
        </a>
        
    </li>
    

            </ul>
        
    </li>
    
    <li>
        <a href="#import-" 
           title="import å¯¼å…¥"
           class="toc-link toc-link-child"
           data-level="3">
            import å¯¼å…¥
        </a>
        
    </li>
    
    <li>
        <a href="#heading-2" 
           title="ç‰ˆæƒå£°æ˜"
           class="toc-link toc-link-child"
           data-level="3">
            ç‰ˆæƒå£°æ˜
        </a>
        
    </li>
    
    <li>
        <a href="#heading-3" 
           title="ç‰ˆæœ¬å£°æ˜"
           class="toc-link toc-link-child"
           data-level="3">
            ç‰ˆæœ¬å£°æ˜
        </a>
        
    </li>
    
    <li>
        <a href="#heading-4" 
           title="å®šä¹‰åˆçº¦"
           class="toc-link toc-link-child"
           data-level="3">
            å®šä¹‰åˆçº¦
        </a>
        
    </li>
    

                    </ul>
                
            </li>
            
            <li>
                <a href="#heading-5" 
                   title="æ•°æ®ç±»å‹å’Œå˜é‡"
                   class="toc-link toc-link-root"
                   data-level="2">
                    æ•°æ®ç±»å‹å’Œå˜é‡
                </a>
                
                    <ul>
                        
    
    <li>
        <a href="#heading-6" 
           title="åŸºæœ¬æ•°æ®ç±»å‹"
           class="toc-link toc-link-child"
           data-level="3">
            åŸºæœ¬æ•°æ®ç±»å‹
        </a>
        
            <ul>
                
    
    <li>
        <a href="#bool" 
           title="å¸ƒå°”å‹ï¼ˆboolï¼‰"
           class="toc-link toc-link-child"
           data-level="4">
            å¸ƒå°”å‹ï¼ˆboolï¼‰
        </a>
        
    </li>
    
    <li>
        <a href="#integer" 
           title="æ•´æ•°ç±»å‹ï¼ˆIntegerï¼‰"
           class="toc-link toc-link-child"
           data-level="4">
            æ•´æ•°ç±»å‹ï¼ˆIntegerï¼‰
        </a>
        
    </li>
    
    <li>
        <a href="#-uint256--gas" 
           title="ä¸ºä»€ä¹ˆ uint256 æœ‰æ—¶å€™æ›´çœ gasï¼Ÿ"
           class="toc-link toc-link-child"
           data-level="4">
            ä¸ºä»€ä¹ˆ uint256 æœ‰æ—¶å€™æ›´çœ gasï¼Ÿ
        </a>
        
    </li>
    
    <li>
        <a href="#address" 
           title="åœ°å€ç±»å‹ï¼ˆAddressï¼‰"
           class="toc-link toc-link-child"
           data-level="4">
            åœ°å€ç±»å‹ï¼ˆAddressï¼‰
        </a>
        
    </li>
    
    <li>
        <a href="#bytes" 
           title="å­—èŠ‚ç±»å‹ï¼ˆBytesï¼‰"
           class="toc-link toc-link-child"
           data-level="4">
            å­—èŠ‚ç±»å‹ï¼ˆBytesï¼‰
        </a>
        
    </li>
    

            </ul>
        
    </li>
    
    <li>
        <a href="#heading-7" 
           title="å¤æ‚æ•°æ®ç±»å‹"
           class="toc-link toc-link-child"
           data-level="3">
            å¤æ‚æ•°æ®ç±»å‹
        </a>
        
            <ul>
                
    
    <li>
        <a href="#heading-8" 
           title="æ•°ç»„"
           class="toc-link toc-link-child"
           data-level="4">
            æ•°ç»„
        </a>
        
    </li>
    
    <li>
        <a href="#heading-9" 
           title="å­—ç¬¦ä¸²"
           class="toc-link toc-link-child"
           data-level="4">
            å­—ç¬¦ä¸²
        </a>
        
    </li>
    
    <li>
        <a href="#heading-10" 
           title="æ˜ å°„"
           class="toc-link toc-link-child"
           data-level="4">
            æ˜ å°„
        </a>
        
    </li>
    

            </ul>
        
    </li>
    
    <li>
        <a href="#heading-11" 
           title="å¸¸é‡"
           class="toc-link toc-link-child"
           data-level="3">
            å¸¸é‡
        </a>
        
            <ul>
                
    
    <li>
        <a href="#constant" 
           title="constant"
           class="toc-link toc-link-child"
           data-level="4">
            constant
        </a>
        
    </li>
    
    <li>
        <a href="#immutable" 
           title="immutable"
           class="toc-link toc-link-child"
           data-level="4">
            immutable
        </a>
        
    </li>
    
    <li>
        <a href="#constant-vs-immutable-" 
           title="constant vs immutable å¦‚ä½•é€‰æ‹©ï¼Ÿ"
           class="toc-link toc-link-child"
           data-level="4">
            constant vs immutable å¦‚ä½•é€‰æ‹©ï¼Ÿ
        </a>
        
    </li>
    

            </ul>
        
    </li>
    

                    </ul>
                
            </li>
            
            <li>
                <a href="#heading-12" 
                   title="å‡½æ•°"
                   class="toc-link toc-link-root"
                   data-level="2">
                    å‡½æ•°
                </a>
                
                    <ul>
                        
    
    <li>
        <a href="#heading-13" 
           title="å‡½æ•°å®šä¹‰"
           class="toc-link toc-link-child"
           data-level="3">
            å‡½æ•°å®šä¹‰
        </a>
        
    </li>
    
    <li>
        <a href="#heading-14" 
           title="å‡½æ•°å¯è§æ€§"
           class="toc-link toc-link-child"
           data-level="3">
            å‡½æ•°å¯è§æ€§
        </a>
        
    </li>
    
    <li>
        <a href="#heading-15" 
           title="å‡½æ•°ä¿®é¥°ç¬¦"
           class="toc-link toc-link-child"
           data-level="3">
            å‡½æ•°ä¿®é¥°ç¬¦
        </a>
        
    </li>
    
    <li>
        <a href="#heading-16" 
           title="ç‰¹æ®Šå‡½æ•°"
           class="toc-link toc-link-child"
           data-level="3">
            ç‰¹æ®Šå‡½æ•°
        </a>
        
    </li>
    
    <li>
        <a href="#heading-17" 
           title="å‡½æ•°é‡è½½"
           class="toc-link toc-link-child"
           data-level="3">
            å‡½æ•°é‡è½½
        </a>
        
    </li>
    

                    </ul>
                
            </li>
            
            <li>
                <a href="#heading-18" 
                   title="ç¨‹åºæ§åˆ¶"
                   class="toc-link toc-link-root"
                   data-level="2">
                    ç¨‹åºæ§åˆ¶
                </a>
                
                    <ul>
                        
    
    <li>
        <a href="#heading-19" 
           title="é”™è¯¯å¤„ç†æœ€ä½³å®è·µ"
           class="toc-link toc-link-child"
           data-level="3">
            é”™è¯¯å¤„ç†æœ€ä½³å®è·µ
        </a>
        
    </li>
    

                    </ul>
                
            </li>
            
            <li>
                <a href="#heading-20" 
                   title="é¢å‘å¯¹è±¡ç‰¹æ€§"
                   class="toc-link toc-link-root"
                   data-level="2">
                    é¢å‘å¯¹è±¡ç‰¹æ€§
                </a>
                
                    <ul>
                        
    
    <li>
        <a href="#heading-21" 
           title="ç»§æ‰¿"
           class="toc-link toc-link-child"
           data-level="3">
            ç»§æ‰¿
        </a>
        
    </li>
    
    <li>
        <a href="#heading-22" 
           title="æ¥å£"
           class="toc-link toc-link-child"
           data-level="3">
            æ¥å£
        </a>
        
    </li>
    
    <li>
        <a href="#heading-23" 
           title="æŠ½è±¡åˆçº¦"
           class="toc-link toc-link-child"
           data-level="3">
            æŠ½è±¡åˆçº¦
        </a>
        
    </li>
    

                    </ul>
                
            </li>
            
            <li>
                <a href="#heading-24" 
                   title="é«˜çº§ç‰¹æ€§"
                   class="toc-link toc-link-root"
                   data-level="2">
                    é«˜çº§ç‰¹æ€§
                </a>
                
                    <ul>
                        
    
    <li>
        <a href="#modifier" 
           title="ä¿®é¥°ç¬¦ï¼ˆmodifierï¼‰"
           class="toc-link toc-link-child"
           data-level="3">
            ä¿®é¥°ç¬¦ï¼ˆmodifierï¼‰
        </a>
        
    </li>
    
    <li>
        <a href="#event" 
           title="äº‹ä»¶ï¼ˆeventï¼‰"
           class="toc-link toc-link-child"
           data-level="3">
            äº‹ä»¶ï¼ˆeventï¼‰
        </a>
        
            <ul>
                
    
    <li>
        <a href="#heading-25" 
           title="äº‹ä»¶çš„å­˜å‚¨ä½ç½®"
           class="toc-link toc-link-child"
           data-level="4">
            äº‹ä»¶çš„å­˜å‚¨ä½ç½®
        </a>
        
    </li>
    
    <li>
        <a href="#heading-26" 
           title="äº‹ä»¶çš„æ¥æ”¶æ–¹å¼"
           class="toc-link toc-link-child"
           data-level="4">
            äº‹ä»¶çš„æ¥æ”¶æ–¹å¼
        </a>
        
    </li>
    
    <li>
        <a href="#heading-27" 
           title="äº‹ä»¶çš„ç‰¹ç‚¹"
           class="toc-link toc-link-child"
           data-level="4">
            äº‹ä»¶çš„ç‰¹ç‚¹
        </a>
        
    </li>
    

            </ul>
        
    </li>
    
    <li>
        <a href="#heading-28" 
           title="äº‹ä»¶é‡æ”¾"
           class="toc-link toc-link-child"
           data-level="3">
            äº‹ä»¶é‡æ”¾
        </a>
        
    </li>
    
    <li>
        <a href="#library" 
           title="åº“ï¼ˆLibraryï¼‰"
           class="toc-link toc-link-child"
           data-level="3">
            åº“ï¼ˆLibraryï¼‰
        </a>
        
    </li>
    
    <li>
        <a href="#unchecked" 
           title="å±è”½æº¢å‡ºæ£€æŸ¥ï¼ˆuncheckedï¼‰"
           class="toc-link toc-link-child"
           data-level="3">
            å±è”½æº¢å‡ºæ£€æŸ¥ï¼ˆuncheckedï¼‰
        </a>
        
    </li>
    
    <li>
        <a href="#heading-29" 
           title="å§”æ‰˜è°ƒç”¨"
           class="toc-link toc-link-child"
           data-level="3">
            å§”æ‰˜è°ƒç”¨
        </a>
        
    </li>
    
    <li>
        <a href="#heading-30" 
           title="å†…è”æ±‡ç¼–"
           class="toc-link toc-link-child"
           data-level="3">
            å†…è”æ±‡ç¼–
        </a>
        
    </li>
    
    <li>
        <a href="#heading-31" 
           title="åˆ›å»ºåˆçº¦"
           class="toc-link toc-link-child"
           data-level="3">
            åˆ›å»ºåˆçº¦
        </a>
        
    </li>
    

                    </ul>
                
            </li>
            
            <li>
                <a href="#heading-32" 
                   title="ç»“è¯­"
                   class="toc-link toc-link-root"
                   data-level="2">
                    ç»“è¯­
                </a>
                
            </li>
            
        </ul>
    </nav>
</div>

            </div>
        </div>
    </div>

    
    <script>
    function toggleToc() {
        const drawer = document.getElementById('tocDrawer');
        if (drawer.classList.contains('translate-x-full')) {
            drawer.classList.remove('translate-x-full');
        } else {
            drawer.classList.add('translate-x-full');
        }
    }
    </script>
    
    
    <div id="articleData" 
         data-verification="{&#34;ArweaveId&#34;:&#34;&#34;,&#34;NftContract&#34;:&#34;&#34;,&#34;Author&#34;:&#34;0x16572b97410200e79AB6c9423F8d9778F0Fb9C54&#34;,&#34;ContentHash&#34;:&#34;0x47c54e59d3e44e9b2ede352ca79e99a7e05a5f7ff9d1208e84a2162583bee4bb1.0.0&#34;,&#34;NFT&#34;:{&#34;Price&#34;:&#34;0&#34;,&#34;MaxSupply&#34;:100,&#34;RoyaltyFee&#34;:1000,&#34;OnePerAddress&#34;:true,&#34;Version&#34;:&#34;1.0.0&#34;,&#34;ChainId&#34;:1,&#34;TokenSymbol&#34;:&#34;ETH&#34;}}"
         data-title="æ¢ç´¢web3ä¸–ç•Œï¼šSolidity å®Œå…¨å…¥é—¨æŒ‡å—"
         style="display: none;">
    </div>

    
    <script>
    function scrollToVerification() {
        const verificationSection = document.getElementById('verification');
        if (verificationSection) {
            const offset = verificationSection.offsetTop; 
            window.scrollTo({
                top: offset,
                behavior: 'smooth'
            });
        }
    }
    </script>

    
    <script>
    function copyHash(hash) {
        
        navigator.clipboard.writeText(hash).then(() => {
            
            window.showToast('æ–‡ç« å†…å®¹å“ˆå¸Œå·²å¤åˆ¶ âœ¨');
        }).catch(() => {
            window.showToast('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
        });
    }
    </script>
</article>

    </main>

    
    
<footer class="py-8 mt-12 bg-stars-secondary/30 backdrop-blur-sm border-t border-stars-accent/10">
    <div class="container mx-auto px-4">
        <div class="flex flex-col md:flex-row justify-between items-center gap-4">
            
            <div class="text-stars-muted text-sm">
                Â© 2025 é²¤å“¥çš„åšå®¢
            </div>

            
            <div class="flex items-center gap-2">
                
                <a href="/feed.xml" 
                   class="flex items-center gap-2 px-3 py-1.5 rounded-lg
                          bg-stars-primary/20 text-stars-muted hover:text-stars-accent
                          border border-stars-accent/10 hover:border-stars-accent/30
                          transition-all duration-300"
                   title="RSS è®¢é˜…">
                    <i class="fas fa-rss"></i>
                    <span class="text-sm">RSS</span>
                </a>

                
                
                <a href="https://buttondown.email/lige" 
                   target="_blank"
                   class="flex items-center gap-2 px-3 py-1.5 rounded-lg
                          bg-stars-primary/20 text-stars-muted hover:text-stars-accent
                          border border-stars-accent/10 hover:border-stars-accent/30
                          transition-all duration-300"
                   title="é‚®ä»¶è®¢é˜…">
                    <i class="fas fa-envelope"></i>
                    <span class="text-sm">é‚®ä»¶è®¢é˜…</span>
                </a>
                
            </div>

            
            <div class="text-stars-muted text-sm">
                Powered by <a href="https://github.com/jiangjiax/stars" 
                            class="text-stars-accent hover:text-stars-gold">Stars</a>
            </div>
        </div>
    </div>
</footer>


    
    <script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs/qrcode.min.js"></script>
    <script src="/static/dist/main.51ab9f649b4caa7df89d.bundle.js"></script>
    
    <script src="/static/dist/nft.ffb817eee87ea86db734.bundle.js"></script>
    
</body>
</html> 